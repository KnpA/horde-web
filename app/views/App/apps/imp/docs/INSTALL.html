<div class="document" id="installing-imp-5-0">
<h1 class="title">Installing IMP 5.0</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Contact:</th>
<td><a class="first last reference external" href="mailto:imp&#64;lists.horde.org">imp&#64;lists.horde.org</a></td></tr>
</tbody>
</table>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="auto-toc simple">
<li><a class="reference internal" href="#prerequisites" id="id1">1&nbsp;&nbsp;&nbsp;Prerequisites</a></li>
<li><a class="reference internal" href="#installing-imp" id="id2">2&nbsp;&nbsp;&nbsp;Installing IMP</a><ul class="auto-toc">
<li><a class="reference internal" href="#installing-with-pear" id="id3">2.1&nbsp;&nbsp;&nbsp;Installing with PEAR</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-imp" id="id4">3&nbsp;&nbsp;&nbsp;Configuring IMP</a></li>
<li><a class="reference internal" href="#obtaining-support" id="id5">4&nbsp;&nbsp;&nbsp;Obtaining Support</a></li>
</ul>
</div>
<p>This document contains instructions for installing the IMP web-based mail
client on your system.</p>
<p>For information on the capabilities and features of IMP, see the file <a class="reference external" href="?f=README.html">README</a>
in the top-level directory of the IMP distribution.</p>
<div class="section" id="prerequisites">
<h1><a class="toc-backref" href="#id1">1&nbsp;&nbsp;&nbsp;Prerequisites</a></h1>
<p>To function properly, IMP <strong>requires</strong> the following:</p>
<ol class="arabic">
<li><p class="first">A working Horde installation.</p>
<p>IMP runs within the <a class="reference external" href="http://www.horde.org/apps/horde">Horde Application Framework</a>, a set of common tools
for web applications written in PHP. You must install Horde before
installing IMP.</p>
<div class="important">
<p class="first admonition-title">Important</p>
<p class="last">IMP 5.0 requires version 4.0+ of the Horde Framework -
earlier versions of Horde will <strong>not</strong> work.</p>
</div>
<div class="important">
<p class="first admonition-title">Important</p>
<p class="last">Be sure to have completed all of the steps in the
<a class="reference external" href="../../horde/docs/?f=INSTALL.html">horde/docs/INSTALL</a> file for the Horde Framework before
installing IMP. Many of IMP's prerequisites are also Horde
prerequisites. Additionally, many of IMP's optional features
are configured via the Horde install.</p>
</div>
</li>
<li><p class="first">The following PHP capabilities:</p>
<div class="important">
<p class="first admonition-title">Important</p>
<p class="last">Certain features in IMP 5 will not work with the suhosin
<strong>extension</strong> (e.g. search mailboxes). You must disable the
suhosin extension to use these features. It is reported that
IMP 5 does work the suhosin <strong>patch</strong>.</p>
</div>
<ol class="loweralpha">
<li><p class="first">File Upload Support</p>
<p>File upload support is <strong>required</strong> to allow attachments in mail
composition and to allow various importing features to work (e.g.
importing PGP or S/MIME keys, importing mbox files).  See
<a class="reference external" href="../../horde/docs/?f=INSTALL.html">horde/docs/INSTALL</a> for instructions on how to enable file upload
support.</p>
</li>
<li><p class="first">OpenSSL support <tt class="docutils literal"><span class="pre">--with-openssl</span></tt></p>
<p>The OpenSSL PHP extension is used by IMP to provide S/MIME support.
Without the extension, all S/MIME options will be disabled.</p>
<p>Additionally, the OpenSSL PHP extension is REQUIRED if using TLS or SSL
to connect to the IMAP/POP3 server.</p>
<p>See <a class="reference external" href="http://www.php.net/openssl">http://www.php.net/openssl</a> for information on compiling OpenSSL
into PHP.</p>
</li>
</ol>
</li>
<li><p class="first">The following PEAR modules:
(See <a class="reference external" href="../../horde/docs/?f=INSTALL.html">horde/docs/INSTALL</a> for instructions on installing PEAR modules)</p>
<div class="important">
<p class="first admonition-title">Important</p>
<p class="last">If you are going to install IMP the recommended way,
i.e. using the PEAR installer, you can skip the remainder of
this section. Installing IMP through PEAR will
automatically download and install all required PEAR modules.</p>
</div>
<ol class="loweralpha">
<li><p class="first">Auth_SASL [OPTIONAL]</p>
<p>Auth_SASL is required only if your IMAP server uses CRAM-MD5 or
DIGEST-MD5 authentication.</p>
</li>
</ol>
</li>
<li><p class="first">At least one IMAP or POP3 server.</p>
<p>While IMP is an application that is installed on a web server and is run
from a web browser, it is only an IMAP and POP3 <em>client</em>, like Outlook,
Apple Mail, or Thunderbird. You must have access to an IMAP or POP3
server(s) on which your users' mail is stored in order to use IMP.</p>
<p>IMAP is <em>strongly</em> recommended over POP3.  See, e.g.,
<a class="reference external" href="http://www.imap.org/imap.vs.pop.brief.html">http://www.imap.org/imap.vs.pop.brief.html</a></p>
<p>Freely available IMAP servers (for *nix systems) that have been verified
to work best with IMP include:</p>
<ul class="simple">
<li>Cyrus (<a class="reference external" href="http://asg.web.cmu.edu/cyrus/">http://asg.web.cmu.edu/cyrus/</a>)</li>
<li>Dovecot (<a class="reference external" href="http://www.dovecot.org/">http://www.dovecot.org/</a>)</li>
<li>Courier-IMAP (<a class="reference external" href="http://www.inter7.com/courierimap.html">http://www.inter7.com/courierimap.html</a>)</li>
</ul>
<p>More available IMAP servers are:</p>
<ul class="simple">
<li>UW-IMAP (<a class="reference external" href="ftp://ftp.cac.washington.edu/imap/">ftp://ftp.cac.washington.edu/imap/</a>)</li>
<li>Archiveopteryx (<a class="reference external" href="http://www.archiveopteryx.org/">http://www.archiveopteryx.org/</a>)</li>
</ul>
<p>Most of these packages also include POP3 support as well.</p>
<p>The selected IMAP server MUST support IMAP4rev1 (<a class="reference external" href="http://www.faqs.org/rfcs/rfc3501.html">RFC 3501</a>).
The selected POP server MUST support POP3 (<a class="reference external" href="http://www.faqs.org/rfcs/rfc1939.html">RFC 1939</a>/STD 53).</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">If using a POP server, it MUST support the UIDL capability.
Caching, on-demand filtering, searching, and sorting will be
disabled; POP3 support is limited to essentially only viewing
messages and performing basic mail actions.</p>
</div>
</li>
<li><p class="first">Sendmail or SMTP server.</p>
<p>Horde sends mail via either a local sendmail or a remote SMTP server.</p>
<p>See <a class="reference external" href="../../horde/docs/?f=INSTALL.html">horde/docs/INSTALL</a> for further information.</p>
</li>
</ol>
<p>The following items are not required, but are strongly <strong>RECOMMENDED</strong>:</p>
<ol class="arabic">
<li><p class="first">Turba, the Horde contacts manager.</p>
<p>Turba is the Horde contact management application, designed to be
integrated with other Horde applications to provide a unified interface to
contact management throughout the Horde suite.</p>
<p>Turba is available from:</p>
<blockquote>
<p><a class="reference external" href="http://www.horde.org/apps/turba">http://www.horde.org/apps/turba</a></p>
</blockquote>
<p>Turba provides the local address book and an LDAP directory search function
to IMP.</p>
<p>You must use the 3.x branch of Turba with IMP 5.x.</p>
</li>
<li><p class="first">Ingo, the Horde mail filters manager.</p>
<p>Ingo is the Horde mail filters management application, designed to be
integrated with other Horde applications to provide a unified interface to
mail filter management throughout the Horde suite.</p>
<p>Ingo is available from:</p>
<blockquote>
<p><a class="reference external" href="http://www.horde.org/apps/ingo">http://www.horde.org/apps/ingo</a></p>
</blockquote>
<p>Ingo provides the mail filtering interfaces to IMP.</p>
<p>You must use the 2.x branch of Ingo with IMP 5.x.</p>
</li>
<li><p class="first">Nag, the Horde tasks manager.</p>
<p>Nag is the Horde tasks management application, designed to be integrated
with other Horde applications to provide a unified interface to task
management throughout the Horde suite.</p>
<p>Nag is available from:</p>
<blockquote>
<p><a class="reference external" href="http://www.horde.org/apps/nag">http://www.horde.org/apps/nag</a></p>
</blockquote>
<p>If Nag is available on your system, users can easily create new tasks from
individual email messages.</p>
<p>You must use the 3.x branch of Nag with IMP 5.x.</p>
</li>
<li><p class="first">Gollem, the Horde file manager.</p>
<p>Gollem is the Horde file management application, designed to be
integrated with other Horde applications to provide a unified interface to
access VFS filesystems throughout the Horde suite.</p>
<p>Gollem is available from:</p>
<blockquote>
<p><a class="reference external" href="http://www.horde.org/apps/gollem">http://www.horde.org/apps/gollem</a></p>
</blockquote>
<p>Gollem allows a user to attach files from various VFS filesystems to
outgoing messages in IMP.</p>
<p>You must use the 2.x branch of Gollem with IMP 5.x.</p>
</li>
<li><p class="first">A web server with PATH_INFO support.</p>
<p>IMP requires the PATH_INFO environment variable for several features. Every
modern web server supports this, but you might have to enable this feature
in the web server configuration. e.g. Apache servers require:</p>
<pre class="literal-block">
AcceptPathInfo On
</pre>
<p>Lighttpd servers require:</p>
<pre class="literal-block">
&quot;broken-scriptfilename&quot; =&gt; &quot;enable&quot;
</pre>
</li>
<li><p class="first">A configured VFS backend.</p>
<p>During composition of messages, it is possible that the PHP session may
timeout. If VFS is enabled in Horde, IMP can store the draft message and
allow the user to recover the message when they next login.</p>
</li>
</ol>
</div>
<div class="section" id="installing-imp">
<h1><a class="toc-backref" href="#id2">2&nbsp;&nbsp;&nbsp;Installing IMP</a></h1>
<p>There are several ways to install IMP. The recommended way to install IMP is
using the PEAR installer. Alternatively it can be installed from
tarballs. Finally, if you want to run the latest development code, or get the
latest, not yet released, fixes, you can install IMP from Git.</p>
<div class="section" id="installing-with-pear">
<h2><a class="toc-backref" href="#id3">2.1&nbsp;&nbsp;&nbsp;Installing with PEAR</a></h2>
<p>First follow the instructions in <a class="reference external" href="../../horde/docs/?f=INSTALL.html">horde/docs/INSTALL</a> to prepare a PEAR
environment for Horde and install the Horde Framework.</p>
<p>When installing IMP through PEAR now, the installer will automatically install
any dependencies of IMP too. If you want to install IMP with all optional
dependencies, but without the binary PECL packages that need to be compiled,
specify both the <tt class="docutils literal"><span class="pre">-a</span></tt> and the <tt class="docutils literal"><span class="pre">-B</span></tt> flag:</p>
<pre class="literal-block">
pear install -a -B horde/imp
</pre>
<p>By default, only the required dependencies will be installed:</p>
<pre class="literal-block">
pear install horde/imp
</pre>
<p>If you want to install IMP even with all optional dependencies, you need to
specify the <tt class="docutils literal"><span class="pre">-a</span></tt> flag. Please note that this might also try to install PHP
extensions through PECL that might need further configuration or activation in
your PHP configuration:</p>
<pre class="literal-block">
pear install -a horde/imp
</pre>
</div>
</div>
<div class="section" id="configuring-imp">
<h1><a class="toc-backref" href="#id4">3&nbsp;&nbsp;&nbsp;Configuring IMP</a></h1>
<ol class="arabic">
<li><p class="first">Configuring Horde for IMP [OPTIONAL]</p>
<p>If you would prefer that your users authenticate directly with IMP, without
having to authenticate through Horde first, load the
<tt class="docutils literal">Administration/Configuration/Authentication</tt> page and from the <tt class="docutils literal">What
backend should we use for authenticating users to Horde</tt> pulldown menu
select <tt class="docutils literal">Let a Horde application handle authentication</tt>.  (Please see the
second note below.) Select <tt class="docutils literal">imp</tt> from the <tt class="docutils literal">The application which is
providing authentication</tt> pulldown menu.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>You will have to log in twice if you don't do this</strong> -- Once to
Horde and a second time to IMP.</p>
</div>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">If this is a new install, you will not be able to configure IMP
using the Horde Administration/Configuration page if you first
enabled IMP authentication for Horde.  You must set Horde to use
another authentication method (refer to the <a class="reference external" href="../../horde/docs/?f=INSTALL.html">horde/docs/INSTALL</a>
file), configure IMP, then reset Horde to use IMP authentication.
One way to reset Horde in order to reach the Administration page
is to replace the Horde configuration file <tt class="docutils literal">conf.php</tt> with the
original in <tt class="docutils literal">horde/config/conf.php.dist</tt>.  You should of course
back up your current settings since they will otherwise be
permanently lost.</p>
</div>
</li>
<li><p class="first">Configuring IMP</p>
<p>You must login to Horde as a Horde Administrator to finish the configuration
of IMP.  Use the Horde <tt class="docutils literal">Administration</tt> menu item to get to the
administration page, and then click on the <tt class="docutils literal">Configuration</tt> icon to get the
configuration page.  Select <tt class="docutils literal">Mail</tt> from the selection list of
applications.  Fill in or change any configuration values as needed.  When
done click on <tt class="docutils literal">Generate Mail Configuration</tt> to generate the <tt class="docutils literal">conf.php</tt>
file.  If your web server doesn't have write permissions to the IMP
configuration directory or file, it will not be able to write the file.  In
this case, go back to <tt class="docutils literal">Configuration</tt> and choose one of the other methods
to create the configuration file <tt class="docutils literal">imp/config/conf.php</tt>.</p>
<p>Documentation on the format and purpose of the other configuration files in
the <tt class="docutils literal">config/</tt> directory can be found in each file. You may create
<tt class="docutils literal">*.local.php</tt> versions of these files if you wish to customize IMP's
appearance and behavior. See the header of the configuration files for
details and examples. The defaults will be correct for most sites.</p>
<p>IMP Configuration Pointers</p>
<ul>
<li><p class="first">By default, IMP is configured to NOT display text/html message parts
inline.  This is done for various security reasons.  If you would like to
see text/html parts inline, you must create a
<tt class="docutils literal">imp/config/mime_drivers.local.php</tt> file with the following content:</p>
<pre class="literal-block">
&lt;?php
$mime_drivers['html']['inline'] = true;
</pre>
</li>
</ul>
</li>
<li><p class="first">Creating the database tables</p>
<p>Once you finished the configuration in the previous step, you can create all
database tables by clicking the <tt class="docutils literal">DB schema is out of date.</tt> link in the
IMP row of the configuration screen.</p>
<p>Alternatively you creating the IMP database tables can be accomplished with
horde's <tt class="docutils literal"><span class="pre">horde-db-migrate</span></tt> utility.  If your database is properly setup in the
Horde configuration, just run the following:</p>
<pre class="literal-block">
horde/bin/horde-db-migrate imp
</pre>
</li>
<li><p class="first">Securing IMP</p>
<p>Before you can secure IMP, you need a secure Horde installation.  Please
read the file in <a class="reference external" href="../../horde/docs/?f=SECURITY.html">horde/docs/SECURITY</a> for Horde security information
before proceeding.</p>
<p>There are two channels by which, unless steps are taken to avoid it, IMP
encourages users to pass their IMAP and POP3 passwords around the Internet
unencrypted.</p>
<p>The first channel is between their browser and the Web server.  We strongly
recommend using an SSL-capable Web server to give users the option of
encrypting communications between their browser and the Web server on which
IMP is running; some sites may wish to disable non-SSL access entirely.</p>
<p>The second channel is between the Web server and their IMAP or POP3 server.
The simplest way to avoid this is to have the mail server running on the
same system as the Web server, and configuring IMP to connect to the IMAP
or POP3 server on <tt class="docutils literal">localhost</tt> instead of on the Internet hostname.  In
cases where that is not possible, it is highly recommended that the mail
server be located on a private, secure network. Alternatively, the mail
server can be accessed via TLS (or via the deprecated SSL-specific ports)
to ensure that users' passwords remain safe after they have entrusted them
to IMP.</p>
<p>Other security steps you can take to increase security include:</p>
<ul class="simple">
<li>Use session cookies instead of URL based sessions.</li>
<li>Set your php <tt class="docutils literal">session.entropy_length</tt> to a larger value (e.g. 16) and
<tt class="docutils literal">session.entropy_file</tt> to a random source (e.g. <tt class="docutils literal">/dev/urandom</tt>)</li>
<li>Enable and use the php mycrypt extension.</li>
<li>If your database, mail server, and web server are on the same host
machine, then:<ul>
<li>Use unix socket database access and disable tcp database access.</li>
<li>Use <tt class="docutils literal">localhost</tt> for all TCP/IP connections to avoid the network.</li>
<li>Use the command-line sendmail for sending mail if possible.</li>
</ul>
</li>
</ul>
</li>
<li><p class="first">Testing IMP</p>
<p>Once you have configured IMP, bring up the Horde test page in your Web
browser to ensure that all necessary prerequisites have been met.  See the
<a class="reference external" href="../../horde/docs/?f=INSTALL.html">horde/docs/INSTALL</a> document for further details on the Horde test
script.</p>
<p>The test script will also allow you to test your connection to the mail
server and provide some auto-detected configuration parameters that can
then be inserted into the server configuration located in
<tt class="docutils literal">imp/config/backends.local.php</tt>.</p>
<p>Next, use IMP to login to a known working IMAP or POP3 server.  Test at
least the following:</p>
<ul class="simple">
<li>Sending mail (via the <tt class="docutils literal">Compose</tt> item in the menu bar).</li>
<li>Setting preferences (check to see if they survive after logging out and
back in, if you are using an SQL or LDAP preferences system).</li>
<li>Reading mail.</li>
<li>Deleting mail.</li>
<li>Flagging mail (if using IMAP).</li>
<li>Changing folders (if using IMAP).</li>
</ul>
</li>
<li><p class="first">Tuning IMP (Performance)</p>
<p>See <a class="reference external" href="../../horde/docs/?f=PERFORMANCE.html">horde/docs/PERFORMANCE</a>.</p>
<p>IMP Specific Performance Information:</p>
<p>IMP can use persistent caching on the server side to store information
about user's messages.  This results in much reduced mail server traffic
and requires the server to parse the structure of every message only once.
The tradeoff is your cache backend must be able to handle the potentially
large amounts of cached data this option will produce. However, cache
storage is potentially cheap when compared to the performance gained by
using caching.</p>
<p>To use this caching, you must have a <tt class="docutils literal">Cache System</tt> configured in Horde's
<tt class="docutils literal">Administration/Configuration</tt> screen and have the relevant settings
enabled in IMP's configuration screen
(<tt class="docutils literal">Administration/Configuration/Webmail/Mailbox</tt>).</p>
</li>
</ol>
</div>
<div class="section" id="obtaining-support">
<h1><a class="toc-backref" href="#id5">4&nbsp;&nbsp;&nbsp;Obtaining Support</a></h1>
<p>If you encounter problems with IMP, help is available!</p>
<p>The Horde Frequently Asked Questions List (FAQ), available on the Web at</p>
<blockquote>
<a class="reference external" href="http://wiki.horde.org/FAQ">http://wiki.horde.org/FAQ</a></blockquote>
<p>The Horde Project runs a number of mailing lists, for individual applications
and for issues relating to the project as a whole.  Information, archives, and
subscription information can be found at</p>
<blockquote>
<a class="reference external" href="http://www.horde.org/community/mail">http://www.horde.org/community/mail</a></blockquote>
<p>Lastly, Horde developers, contributors and users may also be found on IRC,
on the channel #horde on the Freenode Network (irc.freenode.net).</p>
<p>Please keep in mind that IMP is free software written by volunteers.  For
information on reasonable support expectations, please read</p>
<blockquote>
<a class="reference external" href="http://www.horde.org/community/support">http://www.horde.org/community/support</a></blockquote>
<p>Thanks for using IMP!</p>
<p>The IMP team</p>
</div>
</div>
