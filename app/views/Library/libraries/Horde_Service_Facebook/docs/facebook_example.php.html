<div class="document">


<p>&lt;?php
define('HORDE_BASE', '/private/var/www/html/horde');
require_once HORDE_BASE . '/lib/base.php';</p>
<p>// To call Facebook API methods, you will need to set up the application in
// Facebook, and obtain both the api_key and the app_secret.
// See:
//  <a class="reference external" href="http://developers.facebook.com/get_started.php?tab=tutorial">http://developers.facebook.com/get_started.php?tab=tutorial</a></p>
<p>$apikey = 'xxx';    //CHANGE THIS
$secret = 'xxx';    //CHANGE THIS</p>
<dl class="docutils">
<dt>/**</dt>
<dd><ul class="first simple">
<li>Horde_Service_Facebook <em>requires</em> an http_client, http_request objects</li>
<li>and a Horde_Log_Logger object</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 16)</p>
Bullet list ends without a blank line; unexpected unindent.</div>
<p><a href="#id1"><span class="problematic" id="id2">*</span></a>/</p>
<div class="last system-message" id="id1">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 16); <em><a href="#id2">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</dd>
<dt>$context = array('http_client' =&gt; new Horde_Http_Client(),</dt>
<dd>'http_request' =&gt; new Horde_Controller_Request_Http());</dd>
</dl>
<p>/** Create the facebook object <a href="#id3"><span class="problematic" id="id4">**</span></a>/
$facebook = new Horde_Service_Facebook($apikey, $secret, $context);</p>
<div class="system-message" id="id3">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 20); <em><a href="#id4">backlink</a></em></p>
Inline strong start-string without end-string.</div>
<dl class="docutils">
<dt>/**</dt>
<dd><ul class="first simple">
<li>Authenticating and logging into a Facebook app from an external site is</li>
<li>a complicated and multi-stage process.  For these examples, we are assuming</li>
<li>that we have authenticated the application and are either already logged into</li>
<li>Facebook or we have authorized 'offline_access'.</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 28)</p>
Bullet list ends without a blank line; unexpected unindent.</div>
<p><a href="#id5"><span class="problematic" id="id6">*</span></a>/</p>
<div class="last system-message" id="id5">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 28); <em><a href="#id6">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</dd>
<dt>/**</dt>
<dd><ul class="first simple">
<li>If we have a valid cookie, this will know about it. This method should also</li>
<li>be called both after the user has authorized the application and again after</li>
<li>the user has (optionally) authorized infinite sessions (offline_access). Then</li>
<li>you would obtain the infinite session_key by calling auth-&gt;getSessionKey() and</li>
<li>storing the results as you will not be able to retrieve it from FB again.</li>
<li>This is the <em>only</em> way to obtain the session key.</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 37)</p>
Bullet list ends without a blank line; unexpected unindent.</div>
<p><a href="#id7"><span class="problematic" id="id8">*</span></a>/</p>
<div class="last system-message" id="id7">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 37); <em><a href="#id8">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 38)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>//$facebook-&gt;auth-&gt;validateSession();</p>
<p>// Current uid can be obtained with:
//$uid = $facebook-&gt;auth-&gt;getUser();</p>
<p>/** session_key, if you need it, can be obtained via: <a href="#id9"><span class="problematic" id="id10">**</span></a>/
//$sid = $facebook-&gt;auth-&gt;getSessionKey();</p>
<div class="system-message" id="id9">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 43); <em><a href="#id10">backlink</a></em></p>
Inline strong start-string without end-string.</div>
<dl class="docutils">
<dt>/**</dt>
<dd><ul class="first simple">
<li>Otherwise, you would use uid and session_key from prefs or other local</li>
<li>storage and set up the session by calling setUser(). This is how you would</li>
<li>need to do this when utilizing an infinite session_key, since FB will only</li>
<li>send the infinite session_key to you one time only - it's up to client code</li>
<li>to store it.</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 52)</p>
Bullet list ends without a blank line; unexpected unindent.</div>
<p><a href="#id11"><span class="problematic" id="id12">*</span></a>/
$fbp = unserialize($prefs-&gt;getValue('facebook'));
$uid = $fbp['uid'];
$sid = $fbp['sid'];
$facebook-&gt;auth-&gt;setUser($uid, $sid, 0);</p>
<div class="last system-message" id="id11">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 52); <em><a href="#id12">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</dd>
</dl>
<p>/** Use a FQL query to get some friend info <a href="#id13"><span class="problematic" id="id14">**</span></a>/
$result = $facebook-&gt;fql-&gt;run('SELECT name, status FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = ' . $uid . ')');
var_dump($result);</p>
<div class="system-message" id="id13">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 59); <em><a href="#id14">backlink</a></em></p>
Inline strong start-string without end-string.</div>
<p>/** Similar can be done as so using individual api calls...but takes a <em>long</em> time <a href="#id15"><span class="problematic" id="id16">**</span></a>/
//$friends = $facebook-&gt;friends_get();
//  foreach ($friends as $friend) {
//    $personArray = $facebook-&gt;users_getInfo($friend, 'name');
//    $person[] = $personArray[0];
//  }
//
//  foreach ($person as $f) {
//    echo ' ' . $f['name'] . '&lt;br /&gt;';
//  }</p>
<div class="system-message" id="id15">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 63); <em><a href="#id16">backlink</a></em></p>
Inline strong start-string without end-string.</div>
<p>/** Calling code that requires extended permissions <a href="#id17"><span class="problematic" id="id18">**</span></a>/
//try {
//    // Set your Facebook status (requires 'status_update' extended perm)
//    $facebook-&gt;users-&gt;setStatus('is testing my Horde_Service_Facebook client library code...again.');
//} catch (Horde_Service_Facebook_Exception $e) {
//    // Check that we failed because of insufficient app permissions.
//    // then redirect if needed...
//    if ($e-&gt;getCode() == Horde_Service_Facebook_ErrorCodes::API_EC_PERMISSION_STATUS_UPDATE) {
//      // Don't have status_update...tell user/provide link to authorize page etc...</p>
<div class="system-message" id="id17">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 74); <em><a href="#id18">backlink</a></em></p>
Inline strong start-string without end-string.</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 83)</p>
Unexpected indentation.</div>
<blockquote>
// You can get the link to the authorize page like this:</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 84)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>//        $facebook-&gt;auth-&gt;getExtendedPermUrl(
//            Horde_Service_Facebook_Auth::EXTEND_PERMS_STATUSUPDATE,
//            '<a class="reference external" href="http://yourcallbackurl.com">http://yourcallbackurl.com</a>');
//    } else {
//      // Something else
//      echo $e-&gt;getMessage();
//    }
//}</p>
<dl class="docutils">
<dt>/**</dt>
<dd><ul class="first simple">
<li>Alternatively, you could check for the necessary perms first, but IMO, it's</li>
<li>more effecient to get the error since checking the perms and then performing</li>
<li>the action require two round trips to the server.</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 97)</p>
Bullet list ends without a blank line; unexpected unindent.</div>
<p><a href="#id19"><span class="problematic" id="id20">*</span></a>/</p>
<div class="last system-message" id="id19">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 97); <em><a href="#id20">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 98)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>//$hasPerm = $facebook-&gt;users-&gt;hasAppPermissions('status_update');
//if ($hasPerm) {
//    //.....
//}</p>
<dl class="docutils">
<dt>/**</dt>
<dd><ul class="first simple">
<li>Batch mode.</li>
<li>When calling in batch mode, you must assign the results of the method calls</li>
<li>as a reference so when run() is called, you still have a handle to the</li>
<li>results.</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 109)</p>
Bullet list ends without a blank line; unexpected unindent.</div>
<p><a href="#id21"><span class="problematic" id="id22">*</span></a>/</p>
<div class="last system-message" id="id21">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 109); <em><a href="#id22">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 110)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>//$facebook-&gt;batchBegin();
//$notifications = &amp;$facebook-&gt;notifications-&gt;get();
//$friends = &amp;$facebook-&gt;friends-&gt;get();
//$facebook-&gt;batchEnd();
//var_dump($friends);
//var_dump($notifications);</p>
<dl class="docutils">
<dt>/**</dt>
<dd><ul class="first simple">
<li>View a user's pictures. $uid should be the user id whose albums you want to</li>
<li>retrieve. (Permissions permitting, of course)</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 120)</p>
Bullet list ends without a blank line; unexpected unindent.</div>
<p><a href="#id23"><span class="problematic" id="id24">*</span></a>/</p>
<div class="last system-message" id="id23">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 120); <em><a href="#id24">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 121)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>//$albums = $facebook-&gt;photos-&gt;getAlbums($uid);
//var_dump($albums);
//$images = $facebook-&gt;photos-&gt;get('', $albums[0]['aid']);
//var_dump($images);</p>
<dl class="docutils">
<dt>/**</dt>
<dd><ul class="first simple">
<li>Request the raw JSON (or XML) data</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 129)</p>
Bullet list ends without a blank line; unexpected unindent.</div>
<p><a href="#id25"><span class="problematic" id="id26">*</span></a>/</p>
<div class="last system-message" id="id25">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 129); <em><a href="#id26">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 130)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>//$facebook-&gt;dataFormat = Horde_Service_Facebook::DATA_FORMAT_JSON;
//$results = $facebook-&gt;photos-&gt;getAlbums($uid);
//var_dump($results);</p>
<dl class="docutils">
<dt>/**</dt>
<dd><ul class="first simple">
<li>Upload a photo</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 136)</p>
Bullet list ends without a blank line; unexpected unindent.</div>
<p><a href="#id27"><span class="problematic" id="id28">*</span></a>/</p>
<div class="last system-message" id="id27">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 136); <em><a href="#id28">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/var/folders/pn/pnQ3DrPoEfGsZalwagA5EU+++TM/-Tmp-/jv1vfnbf/Horde_Service_Facebook-1.1.2/doc/Horde/Service/Facebook/facebook_example.php</tt>, line 137)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>$path = &quot;/Users/mrubinsk/Desktop/horde_fb.jpg&quot;;
$results = $facebook-&gt;photos-&gt;upload($path);
var_dump($results);</p>
</div>
