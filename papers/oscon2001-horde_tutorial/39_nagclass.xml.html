<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>Presentations :: Nag Storage</title>
<link href="presentation.css" rel="stylesheet" type="text/css" />
</head>

<body>
<table class='oratorHeader' border='0' cellspacing='0' cellpadding='1' width='100%'><tr>
<td width='1%' align='left' class='oratorHeaderBack' valign='center' nowrap='nowrap'><a href="38_class.xml.html" onmouseout="status='';" onmouseover="status='Go to Classes'; return true;"><img src="presentation_back.gif" border="0" alt="" /></a></td><td style="cursor: hand;" onclick="location.href='38_class.xml.html';" align="left" class="oratorHeaderBack" width="24%"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap"><div class='oratorTitleHigh'>Classes</div></td></tr></table></td>
<td width='50%' align='center' class='oratorHeaderBack' valign='center' nowrap='nowrap'><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap"><div class='oratorTitle'>Nag Storage</div></td></tr></table></td>
<td style='cursor: hand;' onclick='location.href="40_subclass.xml.html";' width='24%' align='right' class='oratorHeaderBack' valign='center' nowrap='nowrap'><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap"><div class='oratorTitleHigh'>Subclasses</div></td></tr></table></td><td width="1%" align="right"><a href="40_subclass.xml.html" onmouseout="status='';" onmouseover="status='Go to Subclasses'; return true;"><img src="presentation_forward.gif" border="0" alt="" /></a></td>
</tr></table>
<br /><br /><div align='center'>
<table border='0' width='600'><tr><td align='left'>

<p>
Nag's Storage API
</p>
<code><font color="#000000">
<font color="#0000BB">&lt;?php<br></font><font color="#FF8000">// $Horde: hordeweb/papers/oscon2001-horde_tutorial/39_nagclass.xml.html,v 1.1 2001/12/05 16:48:06 chuck Exp $<br><br>// Return codes<br>/** @constant STORAGE_OK Operation succeeded. */<br></font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'STORAGE_OK'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">0</font><font color="#007700">);<br><br></font><font color="#FF8000">/** @constant STORAGE_ERROR Operation failed. */<br></font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'STORAGE_ERROR'</font><font color="#007700">,&nbsp;-</font><font color="#0000BB">1</font><font color="#007700">);<br><br></font><font color="#FF8000">/** @constant STORAGE_ERROR_PARAMS Bad or missing parameters ($params). */<br></font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'STORAGE_ERROR_PARAMS'</font><font color="#007700">,&nbsp;-</font><font color="#0000BB">2</font><font color="#007700">);<br><br></font><font color="#FF8000">/** @constant STORAGE_ERROR_CONNECT Connection failure. */<br></font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'STORAGE_ERROR_CONNECT'</font><font color="#007700">,&nbsp;-</font><font color="#0000BB">3</font><font color="#007700">);<br><br></font><font color="#FF8000">/** @constant STORAGE_ERROR_AUTH Authentication failure. */<br></font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'STORAGE_ERROR_AUTH'</font><font color="#007700">,&nbsp;-</font><font color="#0000BB">4</font><font color="#007700">);<br><br></font><font color="#FF8000">/** @constant STORAGE_ERROR_EMPTY Empty retrieval result. */<br></font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'STORAGE_ERROR_EMPTY'</font><font color="#007700">,&nbsp;-</font><font color="#0000BB">5</font><font color="#007700">);<br><br></font><font color="#FF8000">// Internal status flags (for bitwise operations)<br>/** @constant TASK_ANY Task has any flag set. */<br></font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'TASK_ANY'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">0</font><font color="#007700">);<br><br></font><font color="#FF8000">/** @constant TASK_ADDED Task has just been added. */<br></font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'TASK_ADDED'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">1</font><font color="#007700">);<br><br></font><font color="#FF8000">/** @constant TASK_MODIFIED Task has been modified. */<br></font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'TASK_MODIFIED'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">2</font><font color="#007700">);<br><br></font><font color="#FF8000">/** @constant TASK_DELETED Task has been deleted. */<br></font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'TASK_DELETED'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">4</font><font color="#007700">);<br><br></font><font color="#FF8000">/**<br> * Nag_Storage:: defines an API for implementing storage backends for Nag.<br> *<br> * @author&nbsp;&nbsp;Jon Parise &lt;jon@horde.org&gt;<br> * @version $Revision: 1.1 $<br> * @since&nbsp;&nbsp;&nbsp;Nag 0.1<br> * @package nag<br> */<br></font><font color="#007700">class&nbsp;</font><font color="#0000BB">Nag_Storage&nbsp;</font><font color="#007700">{<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Array holding the current tast list.&nbsp;&nbsp;Each array entry is a hash<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* describing a task.&nbsp;&nbsp;The array is indexed numerically by task ID.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @var array $tasks<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">var&nbsp;</font><font color="#0000BB">$tasks&nbsp;</font><font color="#007700">=&nbsp;array();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* String containing the current username.&nbsp;&nbsp;This indicates the owner of<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* the current task list.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @var string $user<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">var&nbsp;</font><font color="#0000BB">$user&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#DD0000">''</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Attempts to return a concrete Nag_Storage instance based on $driver.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string&nbsp;&nbsp;&nbsp;&nbsp;$driver&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The type of concrete Nag_Storage subclass<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to return.&nbsp;&nbsp;The is based on the storage<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver ($driver).&nbsp;&nbsp;The code is dynamically<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;included.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string&nbsp;&nbsp;&nbsp;&nbsp;$user&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The name of the user who owns these tasks.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param hash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(optional) A hash containing any additional<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;configuration or connection parameters a<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subclass might need.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return mixed&nbsp;&nbsp;&nbsp;&nbsp;The newly created concrete Nag_Storage instance, or<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false on an error.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;&amp;</font><font color="#0000BB">factory</font><font color="#007700">(</font><font color="#0000BB">$driver</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$user</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$params&nbsp;</font><font color="#007700">=&nbsp;array())<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$driver&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">strtolower</font><font color="#007700">(</font><font color="#0000BB">$driver</font><font color="#007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@include_once&nbsp;</font><font color="#0000BB">dirname</font><font color="#007700">(</font><font color="#0000BB">__FILE__</font><font color="#007700">)&nbsp;.&nbsp;</font><font color="#DD0000">'/Storage/'&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">$driver&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#DD0000">'.php'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$class&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#DD0000">'Nag_Storage_'&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">$driver</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">class_exists</font><font color="#007700">(</font><font color="#0000BB">$class</font><font color="#007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</font><font color="#0000BB">$class</font><font color="#007700">(</font><font color="#0000BB">$user</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$params</font><font color="#007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">false</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Attempts to return a reference to a concrete Nag_Storage instance<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* based on $driver.&nbsp;&nbsp;It wil only create a new instance if no<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Nag_Storage instance with the same parameters currently exists.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* This should be used if multiple storage sources are required.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* This method must be invoked as: $var = &amp;Nag_Storage::singleton()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string&nbsp;&nbsp;&nbsp;&nbsp;$driver&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The type of concrete Nag_Storage subclass<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to return.&nbsp;&nbsp;The is based on the storage<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver ($driver).&nbsp;&nbsp;The code is dynamically<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;included.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string&nbsp;&nbsp;&nbsp;&nbsp;$user&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The name of the user who owns these tasks. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param hash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(optional) A hash containing any additional<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;configuration or connection parameters a<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subclass might need.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return mixed&nbsp;&nbsp;&nbsp;&nbsp;The created concrete Nag_Storage instance, or false<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on error.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;&amp;</font><font color="#0000BB">singleton</font><font color="#007700">(</font><font color="#0000BB">$driver</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$user</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$params&nbsp;</font><font color="#007700">=&nbsp;array())<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;</font><font color="#0000BB">$instances</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!isset(</font><font color="#0000BB">$instances</font><font color="#007700">))&nbsp;</font><font color="#0000BB">$instances&nbsp;</font><font color="#007700">=&nbsp;array();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$signature&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">md5</font><font color="#007700">(</font><font color="#0000BB">strtolower</font><font color="#007700">(</font><font color="#0000BB">$driver</font><font color="#007700">)&nbsp;.&nbsp;</font><font color="#DD0000">']['&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">$user&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">implode</font><font color="#007700">(</font><font color="#DD0000">']['</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$params</font><font color="#007700">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!isset(</font><font color="#0000BB">$instances</font><font color="#007700">[</font><font color="#0000BB">$signature</font><font color="#007700">]))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$instances</font><font color="#007700">[</font><font color="#0000BB">$signature</font><font color="#007700">]&nbsp;=&nbsp;</font><font color="#0000BB">Nag_Storage</font><font color="#007700">::</font><font color="#0000BB">factory</font><font color="#007700">(</font><font color="#0000BB">$driver</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$user</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$params</font><font color="#007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$instances</font><font color="#007700">[</font><font color="#0000BB">$signature</font><font color="#007700">];<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Lists tasks based on the given criteria.&nbsp;&nbsp;All tasks will be returned<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* by default.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$criteria&nbsp;&nbsp;&nbsp;(optional) A set of flags specifying the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set of tasks to return.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return array&nbsp;&nbsp;&nbsp;&nbsp;Returns a list of the requested tasks.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">listTasks</font><font color="#007700">(</font><font color="#0000BB">$criteria&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">TASK_ANY</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* Return all of the tasks by default. */<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if&nbsp;(</font><font color="#0000BB">$criteria&nbsp;</font><font color="#007700">==&nbsp;</font><font color="#0000BB">TASK_ANY</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* Otherwise, return only the set of tasks that match $criteria. */<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$return_set&nbsp;</font><font color="#007700">=&nbsp;array();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks&nbsp;</font><font color="#007700">as&nbsp;</font><font color="#0000BB">$task_id&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">$task</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$task_id</font><font color="#007700">][</font><font color="#DD0000">'flags'</font><font color="#007700">]&nbsp;&amp;&nbsp;</font><font color="#0000BB">$criteria</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$return_set</font><font color="#007700">[</font><font color="#0000BB">$task_id</font><font color="#007700">]&nbsp;=&nbsp;</font><font color="#0000BB">$task</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$return_set</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Adds a new task to the $tasks list.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string&nbsp;&nbsp;&nbsp;&nbsp;$name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The name (short) of the task.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string&nbsp;&nbsp;&nbsp;&nbsp;$desc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The description (long) of the task.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$due&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(optional) The due date of the task.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$priority&nbsp;&nbsp;&nbsp;(optional) The priority of the task.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$depends&nbsp;&nbsp;&nbsp;&nbsp;(optional) The task ID of a dependency.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return integer&nbsp;&nbsp;The numeric ID of the new task.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">addTask</font><font color="#007700">(</font><font color="#0000BB">$name</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$desc</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$due&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">0</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$priority&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">0</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$depends&nbsp;</font><font color="#007700">=&nbsp;-</font><font color="#0000BB">1</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* Create a new task task. */<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$task&nbsp;</font><font color="#007700">=&nbsp;array();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$task</font><font color="#007700">[</font><font color="#DD0000">'name'</font><font color="#007700">]&nbsp;=&nbsp;</font><font color="#0000BB">$name</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$task</font><font color="#007700">[</font><font color="#DD0000">'desc'</font><font color="#007700">]&nbsp;=&nbsp;</font><font color="#0000BB">$desc</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$task</font><font color="#007700">[</font><font color="#DD0000">'added'</font><font color="#007700">]&nbsp;=&nbsp;</font><font color="#0000BB">time</font><font color="#007700">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$task</font><font color="#007700">[</font><font color="#DD0000">'due'</font><font color="#007700">]&nbsp;=&nbsp;</font><font color="#0000BB">$due</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$task</font><font color="#007700">[</font><font color="#DD0000">'priority'</font><font color="#007700">]&nbsp;=&nbsp;</font><font color="#0000BB">$priority</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$task</font><font color="#007700">[</font><font color="#DD0000">'depends'</font><font color="#007700">]&nbsp;=&nbsp;</font><font color="#0000BB">$depends</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$task</font><font color="#007700">[</font><font color="#DD0000">'flags'</font><font color="#007700">]&nbsp;=&nbsp;</font><font color="#0000BB">TASK_ADDED</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* Add it to the $tasks list. */<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[]&nbsp;=&nbsp;</font><font color="#0000BB">$task</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$keys&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">array_keys</font><font color="#007700">(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$keys</font><font color="#007700">[(</font><font color="#0000BB">count</font><font color="#007700">(</font><font color="#0000BB">$keys</font><font color="#007700">)&nbsp;-&nbsp;</font><font color="#0000BB">1</font><font color="#007700">)];<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Modifies an attribute of a task in the $tasks list.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The ID of the task to modify.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string&nbsp;&nbsp;&nbsp;&nbsp;$attribute&nbsp;&nbsp;The attribute of the task to modify.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param mixed&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The new value for $attribute.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return boolean&nbsp;&nbsp;True if the task was successfully marked as modified.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">modifyTask</font><font color="#007700">(</font><font color="#0000BB">$id</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$attribute</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$value</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">])&nbsp;&amp;&amp;&nbsp;isset(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">][</font><font color="#0000BB">$attribute</font><font color="#007700">]))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">][</font><font color="#0000BB">strtolower</font><font color="#007700">(</font><font color="#0000BB">$attribute</font><font color="#007700">)]&nbsp;=&nbsp;</font><font color="#0000BB">$value</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">][</font><font color="#DD0000">'flags'</font><font color="#007700">]&nbsp;|=&nbsp;</font><font color="#0000BB">TASK_MODIFIED</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">][</font><font color="#DD0000">'flags'</font><font color="#007700">]&nbsp;&amp;&nbsp;</font><font color="#0000BB">TASK_MODIFIED</font><font color="#007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">false</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Removes a task from the $tasks list.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The ID of the task to delete.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return boolean&nbsp;&nbsp;True if the task was successfully marked as deleted.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">deleteTask</font><font color="#007700">(</font><font color="#0000BB">$id</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">]))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">][</font><font color="#DD0000">'flags'</font><font color="#007700">]&nbsp;|=&nbsp;</font><font color="#0000BB">TASK_DELETED</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">][</font><font color="#DD0000">'flags'</font><font color="#007700">]&nbsp;&amp;&nbsp;</font><font color="#0000BB">TASK_DELETED</font><font color="#007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">false</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Sets the requested flag to the given value.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The ID of the task task to modify.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$flag&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The flag to modify.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param boolean&nbsp;&nbsp;&nbsp;$state&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The new state of the flag.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">setFlag</font><font color="#007700">(</font><font color="#0000BB">$id</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$flag</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$state</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">]))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$state</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">][</font><font color="#DD0000">'flags'</font><font color="#007700">]&nbsp;!=&nbsp;</font><font color="#0000BB">$flag</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">][</font><font color="#DD0000">'flags'</font><font color="#007700">]&nbsp;&amp;=&nbsp;</font><font color="#0000BB">$flag</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Gets the requested flag's value.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The ID of the task task to examine.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$flag&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The flag whose value to return.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return boolean&nbsp;&nbsp;The state of the requested flag.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">getFlag</font><font color="#007700">(</font><font color="#0000BB">$id</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$flag</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">]))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$id</font><font color="#007700">][</font><font color="#DD0000">'flags'</font><font color="#007700">]&nbsp;&amp;&nbsp;</font><font color="#0000BB">$flag</font><font color="#007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">null</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Purges those tasks that have the "deleted" flag set.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">purgeDeleted</font><font color="#007700">()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$deleted_ids&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">array_keys</font><font color="#007700">(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">listTasks</font><font color="#007700">(</font><font color="#0000BB">TASK_DELETED</font><font color="#007700">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</font><font color="#0000BB">$deleted_ids&nbsp;</font><font color="#007700">as&nbsp;</font><font color="#0000BB">$task_id</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset(</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">tasks</font><font color="#007700">[</font><font color="#0000BB">$task_id</font><font color="#007700">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>}<br></font><font color="#0000BB">?&gt;</font>
</font>
</code><br />


</td></tr></table></div>
</body>
</html>
