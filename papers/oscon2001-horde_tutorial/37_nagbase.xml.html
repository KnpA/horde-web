<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>Presentations :: Nag Base Class</title>
<link href="presentation.css" rel="stylesheet" type="text/css" />
</head>

<body>
<table class='oratorHeader' border='0' cellspacing='0' cellpadding='1' width='100%'><tr>
<td width='1%' align='left' class='oratorHeaderBack' valign='center' nowrap='nowrap'><a href="36_skeleton.xml.html" onmouseout="status='';" onmouseover="status='Go to Skeleton'; return true;"><img src="presentation_back.gif" border="0" alt="" /></a></td><td style="cursor: hand;" onclick="location.href='36_skeleton.xml.html';" align="left" class="oratorHeaderBack" width="24%"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap"><div class='oratorTitleHigh'>Skeleton</div></td></tr></table></td>
<td width='50%' align='center' class='oratorHeaderBack' valign='center' nowrap='nowrap'><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap"><div class='oratorTitle'>Nag Base Class</div></td></tr></table></td>
<td style='cursor: hand;' onclick='location.href="38_class.xml.html";' width='24%' align='right' class='oratorHeaderBack' valign='center' nowrap='nowrap'><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap"><div class='oratorTitleHigh'>Classes</div></td></tr></table></td><td width="1%" align="right"><a href="38_class.xml.html" onmouseout="status='';" onmouseover="status='Go to Classes'; return true;"><img src="presentation_forward.gif" border="0" alt="" /></a></td>
</tr></table>
<br /><br /><div align='center'>
<table border='0' width='600'><tr><td align='left'>

<p>Applications should include all of their core, common functions in a lib/App.php file. Here is Nag's:</p>
<code><font color="#000000">
<font color="#0000BB">&lt;?php<br></font><font color="#FF8000">// $Horde: hordeweb/papers/oscon2001-horde_tutorial/37_nagbase.xml.html,v 1.1 2001/12/05 16:48:06 chuck Exp $<br><br>/** @const NAG_NAME The sitename. */<br></font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'NAG_NAME'</font><font color="#007700">,&nbsp;</font><font color="#DD0000">'Task List Manager'</font><font color="#007700">);<br><br>require_once&nbsp;</font><font color="#0000BB">NAG_BASE&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#DD0000">'/lib/version.php'</font><font color="#007700">;<br><br></font><font color="#FF8000">// Actions<br>/** @const NAG_ADD_TASK Add a new task.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'NAG_ADD_TASK'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">100</font><font color="#007700">);<br></font><font color="#FF8000">/** @const NAG_DELETE_TASKS Delete tasks.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'NAG_DELETE_TASKS'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">101</font><font color="#007700">);<br></font><font color="#FF8000">/** @const NAG_MODIFY_TASK Modify a task.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'NAG_MODIFY_TASK'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">102</font><font color="#007700">);<br></font><font color="#FF8000">/** @const NAG_SAVE_TASK Save a task to storage.&nbsp;&nbsp;*/&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'NAG_SAVE_TASK'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">103</font><font color="#007700">);<br></font><font color="#FF8000">/** @const NAG_SEARCH_TASKS Search the task list. */&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'NAG_SEARCH_TASKS'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">104</font><font color="#007700">);<br><br></font><font color="#FF8000">// Sort types<br>/** @const SORT_NAME Sort by task name.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'SORT_NAME'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">0</font><font color="#007700">);<br></font><font color="#FF8000">/** @const SORT_ADDED Sort by creation date.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'SORT_ADDED'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">1</font><font color="#007700">);<br></font><font color="#FF8000">/** @const SORT_DUE Sort by due date.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'SORT_DUE'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">2</font><font color="#007700">);<br></font><font color="#FF8000">/** @const SORT_PRIORITY Sort by priority.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'SORT_PRIORITY'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">3</font><font color="#007700">);<br></font><font color="#FF8000">/** @const SORT_ASCEND Sort in ascending order.&nbsp;&nbsp;&nbsp;*/&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'SORT_ASCEND'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">0</font><font color="#007700">);<br></font><font color="#FF8000">/** @const SORT_DESCEND Sort in descending order. */&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'SORT_DESCEND'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">1</font><font color="#007700">);<br><br></font><font color="#FF8000">// Priority types<br>/** @const PRIORITY_HIGH High priority task.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'PRIORITY_HIGH'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">0</font><font color="#007700">);<br></font><font color="#FF8000">/** @const PRIORITY_MED Medium priority task.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'PRIORITY_MED'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">10</font><font color="#007700">);<br></font><font color="#FF8000">/** @const PRIORITY_LOW Low priority task.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;</font><font color="#0000BB">define</font><font color="#007700">(</font><font color="#DD0000">'PRIORITY_LOW'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">20</font><font color="#007700">);<br><br></font><font color="#FF8000">/**<br> * Array for mapping priority constants to their string representations.<br> * @var array $priority_map<br> */<br></font><font color="#0000BB">$priority_map&nbsp;</font><font color="#007700">=&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">PRIORITY_HIGH&nbsp;&nbsp;&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"High"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">PRIORITY_MED&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"Medium"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">PRIORITY_LOW&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"Low"</font><font color="#007700">)<br>);<br><br></font><font color="#FF8000">/* Set the umask. */<br></font><font color="#007700">if&nbsp;(isset(</font><font color="#0000BB">$conf</font><font color="#007700">[</font><font color="#DD0000">'umask'</font><font color="#007700">]))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">umask</font><font color="#007700">(</font><font color="#0000BB">$conf</font><font color="#007700">[</font><font color="#DD0000">'umask'</font><font color="#007700">]);<br>}<br><br></font><font color="#FF8000">/**<br> * Nag Base Class.<br> *<br> * @author Jon Parise &lt;jon@horde.org&gt;<br> * @version $Revision: 1.1 $<br> * @package nag<br> */<br></font><font color="#007700">class&nbsp;</font><font color="#0000BB">Nag&nbsp;</font><font color="#007700">{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Retrieves the current user's task list from storage.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* This function will also sort the resulting list, if requested.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param $storage&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The current storage object.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param $criteria&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(optional) A set of flags specifying the set of<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tasks to return. (TASK_ADDED, TASK_MODIFIED,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TASK_DELETED)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param $sortby&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(optional) The field by which to sort.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SORT_NAME, SORT_ADDED, SORT_DUE)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param $sortdir&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(optional) The direction by which to sort.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SORT_ASC, SORT_DESC)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return array&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a list of the requested tasks.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @see Nag_Storage::listTasks<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">listTasks</font><font color="#007700">(</font><font color="#0000BB">$storage</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$criteria&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">0</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$sortby&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">SORT_ADDED</font><font color="#007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sortdir&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">SORT_ASCEND</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* Retrieve the task list for storage. */<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$tasks&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">$storage</font><font color="#007700">-&gt;</font><font color="#0000BB">listTasks</font><font color="#007700">(</font><font color="#0000BB">$criteria</font><font color="#007700">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* Sort the task list. */<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sort_functions&nbsp;</font><font color="#007700">=&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">SORT_PRIORITY&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#DD0000">'ByPriority'</font><font color="#007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">SORT_NAME&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#DD0000">'ByName'</font><font color="#007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">SORT_ADDED&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#DD0000">'ByAdded'</font><font color="#007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">SORT_DUE&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#DD0000">'ByDue'<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* Sort the array if we have a sort function defined for this field. */<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">if&nbsp;(isset(</font><font color="#0000BB">$sort_functions</font><font color="#007700">[</font><font color="#0000BB">$sortby</font><font color="#007700">]))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$prefix&nbsp;</font><font color="#007700">=&nbsp;(</font><font color="#0000BB">$sortdir&nbsp;</font><font color="#007700">==&nbsp;</font><font color="#0000BB">SORT_DESCEND</font><font color="#007700">)&nbsp;?&nbsp;</font><font color="#DD0000">'_rsort'&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#DD0000">'_sort'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">uasort</font><font color="#007700">(</font><font color="#0000BB">$tasks</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$prefix&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">$sort_functions</font><font color="#007700">[</font><font color="#0000BB">$sortby</font><font color="#007700">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$tasks</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Generates the HTML for a day selection widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string $name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The name of the widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;$timestamp&nbsp;&nbsp;&nbsp;&nbsp;(optional) The timestamp to select by default.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string $javascript&nbsp;&nbsp;&nbsp;(optional) Any onchange, onblur, etc. javascript to include.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The HTML &lt;select&gt; widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">buildDayWidget</font><font color="#007700">(</font><font color="#0000BB">$name</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$timestamp&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$javascript&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$selected&nbsp;</font><font color="#007700">=&nbsp;(isset(</font><font color="#0000BB">$timestamp</font><font color="#007700">))&nbsp;?&nbsp;</font><font color="#0000BB">date</font><font color="#007700">(</font><font color="#DD0000">'d'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$timestamp</font><font color="#007700">)&nbsp;:&nbsp;</font><font color="#0000BB">null</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#DD0000">"&lt;select&nbsp;name=</font><font color="#007700">\"</font><font color="#DD0000">$name</font><font color="#007700">\"</font><font color="#DD0000">"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$javascript&nbsp;</font><font color="#007700">!=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">' '&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">$javascript</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">'&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(</font><font color="#0000BB">$day&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">1</font><font color="#007700">;&nbsp;</font><font color="#0000BB">$day&nbsp;</font><font color="#007700">&lt;=&nbsp;</font><font color="#0000BB">31</font><font color="#007700">;&nbsp;</font><font color="#0000BB">$day</font><font color="#007700">++)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;option&nbsp;value=</font><font color="#007700">\"</font><font color="#DD0000">$day</font><font color="#007700">\"</font><font color="#DD0000">"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;(</font><font color="#0000BB">$day&nbsp;</font><font color="#007700">==&nbsp;</font><font color="#0000BB">$selected</font><font color="#007700">)&nbsp;?&nbsp;</font><font color="#DD0000">' selected&gt;'&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#DD0000">'&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"$day&lt;/option&gt;"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;/select&gt;\n"</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$html</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Generates the HTML for a month selection widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string $name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The name of the widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;$timestamp&nbsp;&nbsp;&nbsp;&nbsp;(optional) The timestamp to select by default.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string $javascript&nbsp;&nbsp;&nbsp;(optional) Any onchange, onblur, etc. javascript to include.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The HTML &lt;select&gt; widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">buildMonthWidget</font><font color="#007700">(</font><font color="#0000BB">$name</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$timestamp&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$javascript&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$months&nbsp;</font><font color="#007700">=&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">1&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"January"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">2&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"February"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">3&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"March"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">4&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"April"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">5&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"May"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">6&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"June"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">7&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"July"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">8&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"August"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">9&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"September"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">10&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"October"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">11&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"November"</font><font color="#007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">12&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"December"</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$selected&nbsp;</font><font color="#007700">=&nbsp;(isset(</font><font color="#0000BB">$timestamp</font><font color="#007700">))&nbsp;?&nbsp;</font><font color="#0000BB">date</font><font color="#007700">(</font><font color="#DD0000">'m'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$timestamp</font><font color="#007700">)&nbsp;:&nbsp;</font><font color="#0000BB">null</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#DD0000">"&lt;select&nbsp;name=</font><font color="#007700">\"</font><font color="#DD0000">$name</font><font color="#007700">\"</font><font color="#DD0000">"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$javascript&nbsp;</font><font color="#007700">!=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">' '&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">$javascript</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">'&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(</font><font color="#0000BB">$month&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">1</font><font color="#007700">;&nbsp;</font><font color="#0000BB">$month&nbsp;</font><font color="#007700">&lt;=&nbsp;</font><font color="#0000BB">12</font><font color="#007700">;&nbsp;</font><font color="#0000BB">$month</font><font color="#007700">++)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;option&nbsp;value=</font><font color="#007700">\"</font><font color="#DD0000">$month</font><font color="#007700">\"</font><font color="#DD0000">"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;(</font><font color="#0000BB">$month&nbsp;</font><font color="#007700">==&nbsp;</font><font color="#0000BB">$selected</font><font color="#007700">)&nbsp;?&nbsp;</font><font color="#DD0000">' selected&gt;'&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#DD0000">'&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#0000BB">$months</font><font color="#007700">[</font><font color="#0000BB">$month</font><font color="#007700">]&nbsp;.&nbsp;</font><font color="#DD0000">'&lt;/option&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;/select&gt;\n"</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$html</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Generates the HTML for a year selection widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;$name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The name of the widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;$years&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The number of years into the future to include.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string $timestamp&nbsp;&nbsp;&nbsp;&nbsp;(optional) The timestamp to select by default.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string $javascript&nbsp;&nbsp;&nbsp;(optional) Any onchange, onblur, etc. javascript to include.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The HTML &lt;select&gt; widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">buildYearWidget</font><font color="#007700">(</font><font color="#0000BB">$name</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$years</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$timestamp&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$javascript&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$selected&nbsp;</font><font color="#007700">=&nbsp;(isset(</font><font color="#0000BB">$timestamp</font><font color="#007700">))&nbsp;?&nbsp;</font><font color="#0000BB">date</font><font color="#007700">(</font><font color="#DD0000">'Y'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$timestamp</font><font color="#007700">)&nbsp;:&nbsp;</font><font color="#0000BB">null</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#DD0000">"&lt;select&nbsp;name=</font><font color="#007700">\"</font><font color="#DD0000">$name</font><font color="#007700">\"</font><font color="#DD0000">"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$javascript&nbsp;</font><font color="#007700">!=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">' '&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">$javascript</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">'&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(</font><font color="#0000BB">$year&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">date</font><font color="#007700">(</font><font color="#DD0000">'Y'</font><font color="#007700">);&nbsp;</font><font color="#0000BB">$year&nbsp;</font><font color="#007700">&lt;&nbsp;(</font><font color="#0000BB">date</font><font color="#007700">(</font><font color="#DD0000">'Y'</font><font color="#007700">)&nbsp;+&nbsp;</font><font color="#0000BB">$years</font><font color="#007700">);&nbsp;</font><font color="#0000BB">$year</font><font color="#007700">++)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;option&nbsp;value=</font><font color="#007700">\"</font><font color="#DD0000">$year</font><font color="#007700">\"</font><font color="#DD0000">"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;(</font><font color="#0000BB">$year&nbsp;</font><font color="#007700">==&nbsp;</font><font color="#0000BB">$selected</font><font color="#007700">)&nbsp;?&nbsp;</font><font color="#DD0000">' selected&gt;'&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#DD0000">'&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"$year&lt;/option&gt;"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;/select&gt;\n"</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$html</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Generates the HTML for an hour selection widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param strin $name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The name of the widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;$timestamp&nbsp;&nbsp;&nbsp;&nbsp;(optional) The timestamp to select by default.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string $javascript&nbsp;&nbsp;&nbsp;(optional) Any onchange, onblur, etc. javascript to include.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The HTML &lt;select&gt; widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">buildHourWidget</font><font color="#007700">(</font><font color="#0000BB">$name</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$timestamp&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$javascript&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$selected&nbsp;</font><font color="#007700">=&nbsp;(isset(</font><font color="#0000BB">$timestamp</font><font color="#007700">))&nbsp;?&nbsp;</font><font color="#0000BB">date</font><font color="#007700">(</font><font color="#DD0000">'H'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$timestamp</font><font color="#007700">)&nbsp;:&nbsp;</font><font color="#0000BB">null</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#DD0000">"&lt;select&nbsp;name=</font><font color="#007700">\"</font><font color="#DD0000">$name</font><font color="#007700">\"</font><font color="#DD0000">"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$javascript&nbsp;</font><font color="#007700">!=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">' '&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">$javascript</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">'&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(</font><font color="#0000BB">$hour&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">0</font><font color="#007700">;&nbsp;</font><font color="#0000BB">$hour&nbsp;</font><font color="#007700">&lt;=&nbsp;</font><font color="#0000BB">23</font><font color="#007700">;&nbsp;</font><font color="#0000BB">$hour</font><font color="#007700">++)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;option&nbsp;value=</font><font color="#007700">\"</font><font color="#DD0000">$hour</font><font color="#007700">\"</font><font color="#DD0000">"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;(</font><font color="#0000BB">$hour&nbsp;</font><font color="#007700">==&nbsp;</font><font color="#0000BB">$selected</font><font color="#007700">)&nbsp;?&nbsp;</font><font color="#DD0000">' selected&gt;'&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#DD0000">'&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#0000BB">sprintf</font><font color="#007700">(</font><font color="#DD0000">"%02d"</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$hour</font><font color="#007700">)&nbsp;.&nbsp;</font><font color="#DD0000">'&lt;/option&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;/select&gt;\n"</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$html</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Generates the HTML for a minute selection widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string $name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The name of the widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;$increment&nbsp;&nbsp;&nbsp;&nbsp;(optional) The increment between minutes.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param int&nbsp;&nbsp;&nbsp;&nbsp;$timestamp&nbsp;&nbsp;&nbsp;&nbsp;(optional) The timestamp to select by default.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param string $javascript&nbsp;&nbsp;&nbsp;(optional) Any onchange, onblur, etc. javascript to include.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The HTML &lt;select&gt; widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">buildMinuteWidget</font><font color="#007700">(</font><font color="#0000BB">$name</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$increment&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">1</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$timestamp&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$javascript&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$selected&nbsp;</font><font color="#007700">=&nbsp;(isset(</font><font color="#0000BB">$timestamp</font><font color="#007700">))&nbsp;?&nbsp;</font><font color="#0000BB">date</font><font color="#007700">(</font><font color="#DD0000">'i'</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$timestamp</font><font color="#007700">)&nbsp;:&nbsp;</font><font color="#0000BB">null</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#DD0000">"&lt;select&nbsp;name=</font><font color="#007700">\"</font><font color="#DD0000">$name</font><font color="#007700">\"</font><font color="#DD0000">"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$javascript&nbsp;</font><font color="#007700">!=&nbsp;</font><font color="#0000BB">null</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">' '&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">$javascript</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">'&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(</font><font color="#0000BB">$minute&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">0</font><font color="#007700">;&nbsp;</font><font color="#0000BB">$minute&nbsp;</font><font color="#007700">&lt;=&nbsp;</font><font color="#0000BB">60</font><font color="#007700">;&nbsp;</font><font color="#0000BB">$minute&nbsp;</font><font color="#007700">+=&nbsp;</font><font color="#0000BB">$increment</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;option&nbsp;value=</font><font color="#007700">\"</font><font color="#DD0000">$minute</font><font color="#007700">\"</font><font color="#DD0000">"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;(</font><font color="#0000BB">$minute&nbsp;</font><font color="#007700">==&nbsp;</font><font color="#0000BB">$selected</font><font color="#007700">)&nbsp;?&nbsp;</font><font color="#DD0000">' selected&gt;'&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#DD0000">'&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#0000BB">sprintf</font><font color="#007700">(</font><font color="#DD0000">"%02d"</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$minute</font><font color="#007700">)&nbsp;.&nbsp;</font><font color="#DD0000">'&lt;/option&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;/select&gt;\n"</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$html</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Builds the HTML for a task list selection widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param $name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The name of the widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param $tasks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The array of tasks.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param $selected&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(optional) The default selected item in the list.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param $none&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(optional) Include a 'None' item in the task list.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The HTML &lt;select&gt; widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">buildTaskListWidget</font><font color="#007700">(</font><font color="#0000BB">$name</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$tasks</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$selected&nbsp;</font><font color="#007700">=&nbsp;-</font><font color="#0000BB">1</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$none&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">false</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#DD0000">"&lt;select&nbsp;name=</font><font color="#007700">\"</font><font color="#DD0000">$name</font><font color="#007700">\"</font><font color="#DD0000">&gt;"</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$none</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">'&lt;option value="-1"&gt;'&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"None"</font><font color="#007700">)&nbsp;.&nbsp;</font><font color="#DD0000">'&lt;/option&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">ksort</font><font color="#007700">(</font><font color="#0000BB">$tasks</font><font color="#007700">,&nbsp;</font><font color="#0000BB">SORT_NUMERIC</font><font color="#007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</font><font color="#0000BB">$tasks&nbsp;</font><font color="#007700">as&nbsp;</font><font color="#0000BB">$id&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">$task</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;option&nbsp;value=</font><font color="#007700">\"</font><font color="#DD0000">$id</font><font color="#007700">\"</font><font color="#DD0000">"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;(</font><font color="#0000BB">$id&nbsp;</font><font color="#007700">==&nbsp;</font><font color="#0000BB">$selected</font><font color="#007700">)&nbsp;?&nbsp;</font><font color="#DD0000">' selected&gt;'&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#DD0000">'&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#0000BB">htmlspecialchars</font><font color="#007700">(</font><font color="#0000BB">$task</font><font color="#007700">[</font><font color="#DD0000">'name'</font><font color="#007700">])&nbsp;.&nbsp;</font><font color="#DD0000">'&lt;/option&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;/select&gt;\n"</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$html</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Builds the HTML for a priority selection widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param $name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The name of the widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param $selected&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(optional) The default selected priority.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The HTML &lt;select&gt; widget.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">buildPriorityWidget</font><font color="#007700">(</font><font color="#0000BB">$name</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$selected&nbsp;</font><font color="#007700">=&nbsp;-</font><font color="#0000BB">1</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</font><font color="#0000BB">$priority_map</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#DD0000">"&lt;select&nbsp;name=</font><font color="#007700">\"</font><font color="#DD0000">$name</font><font color="#007700">\"</font><font color="#DD0000">&gt;"</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</font><font color="#0000BB">$priority_map&nbsp;</font><font color="#007700">as&nbsp;</font><font color="#0000BB">$priority&nbsp;</font><font color="#007700">=&gt;&nbsp;</font><font color="#0000BB">$name</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;option&nbsp;value=</font><font color="#007700">\"</font><font color="#DD0000">$priority</font><font color="#007700">\"</font><font color="#DD0000">"</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;(</font><font color="#0000BB">$priority&nbsp;</font><font color="#007700">==&nbsp;</font><font color="#0000BB">$selected</font><font color="#007700">)&nbsp;?&nbsp;</font><font color="#DD0000">' selected&gt;'&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#DD0000">'&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#0000BB">$name&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#DD0000">'&lt;/option&gt;'</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$html&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">"&lt;/select&gt;\n"</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$html</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Formats the given Unix-style date string.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param $unixdate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Unix-style date value to format.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The formatted due date string.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">formatDate</font><font color="#007700">(</font><font color="#0000BB">$unixdate&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#DD0000">''</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</font><font color="#0000BB">$conf</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(empty(</font><font color="#0000BB">$unixdate</font><font color="#007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"None"</font><font color="#007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$s&nbsp;</font><font color="#007700">=&nbsp;</font><font color="#0000BB">strftime</font><font color="#007700">(</font><font color="#0000BB">$conf</font><font color="#007700">[</font><font color="#DD0000">'view'</font><font color="#007700">][</font><font color="#DD0000">'date_format'</font><font color="#007700">],&nbsp;</font><font color="#0000BB">$unixdate</font><font color="#007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$s&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#DD0000">' '&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"at"</font><font color="#007700">)&nbsp;.&nbsp;</font><font color="#DD0000">' '</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$s&nbsp;</font><font color="#007700">.=&nbsp;</font><font color="#0000BB">strftime</font><font color="#007700">(</font><font color="#0000BB">$conf</font><font color="#007700">[</font><font color="#DD0000">'view'</font><font color="#007700">][</font><font color="#DD0000">'time_format'</font><font color="#007700">],&nbsp;</font><font color="#0000BB">$unixdate</font><font color="#007700">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$s</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/**<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Returns the string representation of the given priority.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param $priority&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The priority value.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @return string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The string representation of $priority.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function&nbsp;</font><font color="#0000BB">formatPriority</font><font color="#007700">(</font><font color="#0000BB">$priority</font><font color="#007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</font><font color="#0000BB">$priority_map</font><font color="#007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">in_array</font><font color="#007700">(</font><font color="#0000BB">$priority</font><font color="#007700">,&nbsp;</font><font color="#0000BB">array_keys</font><font color="#007700">(</font><font color="#0000BB">$priority_map</font><font color="#007700">)))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$priority&nbsp;</font><font color="#007700">==&nbsp;</font><font color="#0000BB">PRIORITY_HIGH</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">Horde</font><font color="#007700">::</font><font color="#0000BB">img</font><font color="#007700">(</font><font color="#DD0000">'high.gif'</font><font color="#007700">)&nbsp;.&nbsp;</font><font color="#DD0000">'&amp;nbsp;'&nbsp;</font><font color="#007700">.&nbsp;</font><font color="#0000BB">$priority_map</font><font color="#007700">[</font><font color="#0000BB">$priority</font><font color="#007700">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;elseif&nbsp;(</font><font color="#0000BB">$priority&nbsp;</font><font color="#007700">==&nbsp;</font><font color="#0000BB">PRIORITY_LOW</font><font color="#007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">Horde</font><font color="#007700">::</font><font color="#0000BB">img</font><font color="#007700">(</font><font color="#DD0000">'low.gif'</font><font color="#007700">)&nbsp;.&nbsp;</font><font color="#DD0000">'&amp;nbsp;'</font><font color="#007700">.&nbsp;</font><font color="#0000BB">$priority_map</font><font color="#007700">[</font><font color="#0000BB">$priority</font><font color="#007700">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">$priority_map</font><font color="#007700">[</font><font color="#0000BB">$priority</font><font color="#007700">];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"Unknown"</font><font color="#007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br>function&nbsp;</font><font color="#0000BB">_sortByPriority</font><font color="#007700">(</font><font color="#0000BB">$a</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'priority'</font><font color="#007700">]&nbsp;==&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'priority'</font><font color="#007700">])&nbsp;return&nbsp;</font><font color="#0000BB">0</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'priority'</font><font color="#007700">]&nbsp;&gt;&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'priority'</font><font color="#007700">])&nbsp;?&nbsp;-</font><font color="#0000BB">1&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#0000BB">1</font><font color="#007700">;<br>}<br><br>function&nbsp;</font><font color="#0000BB">_rsortByPriority</font><font color="#007700">(</font><font color="#0000BB">$a</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'priority'</font><font color="#007700">]&nbsp;==&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'priority'</font><font color="#007700">])&nbsp;return&nbsp;</font><font color="#0000BB">0</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'priority'</font><font color="#007700">]&nbsp;&lt;&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'priority'</font><font color="#007700">])&nbsp;?&nbsp;-</font><font color="#0000BB">1&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#0000BB">1</font><font color="#007700">;<br>}<br><br>function&nbsp;</font><font color="#0000BB">_sortByName</font><font color="#007700">(</font><font color="#0000BB">$a</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">strcmp</font><font color="#007700">(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'name'</font><font color="#007700">],&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'name'</font><font color="#007700">]);<br>}<br><br>function&nbsp;</font><font color="#0000BB">_rsortByName</font><font color="#007700">(</font><font color="#0000BB">$a</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000BB">strcmp</font><font color="#007700">(</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'name'</font><font color="#007700">],&nbsp;</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'name'</font><font color="#007700">]);<br>}<br><br>function&nbsp;</font><font color="#0000BB">_sortByAdded</font><font color="#007700">(</font><font color="#0000BB">$a</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'added'</font><font color="#007700">]&nbsp;==&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'added'</font><font color="#007700">])&nbsp;return&nbsp;</font><font color="#0000BB">0</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'added'</font><font color="#007700">]&nbsp;&gt;&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'added'</font><font color="#007700">])&nbsp;?&nbsp;-</font><font color="#0000BB">1&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#0000BB">1</font><font color="#007700">;<br>}<br><br>function&nbsp;</font><font color="#0000BB">_rsortByAdded</font><font color="#007700">(</font><font color="#0000BB">$a</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'added'</font><font color="#007700">]&nbsp;==&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'added'</font><font color="#007700">])&nbsp;return&nbsp;</font><font color="#0000BB">0</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'added'</font><font color="#007700">]&nbsp;&lt;&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'added'</font><font color="#007700">])&nbsp;?&nbsp;-</font><font color="#0000BB">1&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#0000BB">1</font><font color="#007700">;<br>}<br><br>function&nbsp;</font><font color="#0000BB">_sortByDue</font><font color="#007700">(</font><font color="#0000BB">$a</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'due'</font><font color="#007700">]&nbsp;==&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'due'</font><font color="#007700">])&nbsp;return&nbsp;</font><font color="#0000BB">0</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'due'</font><font color="#007700">]&nbsp;&gt;&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'due'</font><font color="#007700">])&nbsp;?&nbsp;-</font><font color="#0000BB">1&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#0000BB">1</font><font color="#007700">;<br>}<br><br>function&nbsp;</font><font color="#0000BB">_rsortByDue</font><font color="#007700">(</font><font color="#0000BB">$a</font><font color="#007700">,&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'due'</font><font color="#007700">]&nbsp;==&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'due'</font><font color="#007700">])&nbsp;return&nbsp;</font><font color="#0000BB">0</font><font color="#007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</font><font color="#0000BB">$a</font><font color="#007700">[</font><font color="#DD0000">'due'</font><font color="#007700">]&nbsp;&lt;&nbsp;</font><font color="#0000BB">$b</font><font color="#007700">[</font><font color="#DD0000">'due'</font><font color="#007700">])&nbsp;?&nbsp;-</font><font color="#0000BB">1&nbsp;</font><font color="#007700">:&nbsp;</font><font color="#0000BB">1</font><font color="#007700">;<br>}<br><br></font><font color="#0000BB">?&gt;<br></font>
</font>
</code><br />



</td></tr></table></div>
</body>
</html>
