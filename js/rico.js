var Rico={Version:"2.1",loadRequested:1,loadComplete:2,init:function(){try{document.execCommand("BackgroundImageCache",false,true)}catch(g){}this.preloadMsgs="";var b=document.getElementsByTagName("script");this.baseHref=location.protocol+"//"+location.host;this.loadedFiles={};this.windowIsLoaded=false;this.onLoadCallbacks=[];var d,c;for(var h=0;h<b.length;h++){if(!b[h].src){continue}var a=b[h].src;var j=a.lastIndexOf("/");var l=a.substring(0,j+1);d=a.substring(j+1);var k=d.indexOf("?");if(k>0){d=d.substring(0,k)}this.loadedFiles[d]=this.loadComplete;if(d=="rico.js"||d=="min.rico.js"){c=d;var f=(l.indexOf("/javascripts")>=0);if(f){this.jsDir="/javascripts/";this.cssDir="/stylesheets/";this.imgDir="/images/";this.htmDir="/";this.xslDir="/"}else{this.jsDir=l;this.cssDir=l+"css/";this.imgDir=l+"images/";this.htmDir=l;this.xslDir=l}}}if(!c){throw("unable to locate rico.js or min.rico.js script element")}if(typeof Prototype=="undefined"){if(typeof(google)=="object"&&google.load){google.load("prototype","1.6")}else{this.include("prototype.js")}}if(c=="rico.js"){this.include("ricoCommon.js");this.languageInclude("en")}var e=function(){Rico.windowLoaded()};if(window.addEventListener){window.addEventListener("load",e,false)}else{if(window.attachEvent){window.attachEvent("onload",e)}}this.onLoad(function(){Rico.writeDebugMsg("Pre-load messages:\n"+Rico.preloadMsgs)})},moduleDependencies:{Accordion:["ricoBehaviors.js","ricoEffects.js","ricoComponents.js"],Color:["ricoStyles.js"],Corner:["ricoStyles.js"],DragAndDrop:["ricoStyles.js","ricoEffects.js","ricoDragDrop.js"],Effect:["ricoEffects.js"],Calendar:["ricoCalendar.js","ricoCalendar.css"],Tree:["ricoTree.js","ricoTree.css"],ColorPicker:["ricoColorPicker.js","ricoStyles.js","ricoColorPicker.css"],CustomMenu:["ricoMenu.js","ricoMenu.css"],SimpleGrid:["+Effect","ricoGridCommon.js","ricoGrid.css","ricoSimpleGrid.js"],LiveGridBasic:["ricoGridCommon.js","ricoGrid.css","ricoBehaviors.js","ricoLiveGrid.js"],LiveGrid:["+Effect","+LiveGridBasic","ricoLiveGridControls.js"],LiveGridMenu:["+CustomMenu","ricoLiveGridMenu.js"],LiveGridAjax:["+LiveGrid","ricoLiveGridAjax.js"],LiveGridJSON:["+LiveGridAjax","ricoLiveGridJSON.js"],LiveGridForms:["+LiveGridAjax","+LiveGridMenu","+Accordion","+Corner","ricoLiveGridForms.js","ricoLiveGridForms.css"],SpreadSheet:["+SimpleGrid","ricoSheet.js","ricoSheet.css"]},languages:{de:"translations/ricoLocale_de.js",en:"translations/ricoLocale_en.js",es:"translations/ricoLocale_es.js",fr:"translations/ricoLocale_fr.js",it:"translations/ricoLocale_it.js",ja:"translations/ricoLocale_ja.js",ko:"translations/ricoLocale_ko.js",pt:"translations/ricoLocale_pt.js",zh:"translations/ricoLocale_zh.js"},languageInclude:function(b){var a=this.languages[b];if(a){this.include(a)}return!!a},acceptLanguage:function(c){var a=c.toLowerCase().split(",");for(var b=0;b<a.length;b++){var d=a[b].match(/\w\w/);if(!d){continue}if(this.languageInclude(d)){return true}}return false},loadModule:function(){for(var b=0,e=arguments.length;b<e;b++){var c=arguments[b];var f=this.moduleDependencies[c];if(f){for(var d=0;d<f.length;d++){if(f[d].substring(0,1)=="+"){this.loadModule(f[d].slice(1))}else{this.include(f[d])}}}else{this.include(c)}}},include:function(a){if(this.loadedFiles[a]){return}this.addPreloadMsg("include: "+a);var c=a.substr(a.lastIndexOf(".")+1);switch(c.toLowerCase()){case"js":this.loadedFiles[a]=a.substring(0,4)=="rico"?this.loadRequested:this.loadComplete;document.write("<script type='text/javascript' src='"+this.jsDir+a+"'><\/script>");return;case"css":var b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href=this.cssDir+a;this.loadedFiles[a]=this.loadComplete;document.getElementsByTagName("head")[0].appendChild(b);return}},includeLoaded:function(a){this.loadedFiles[a]=this.loadComplete;this.checkIfComplete()},windowLoaded:function(){this.windowIsLoaded=true;this.checkIfComplete()},checkIfComplete:function(){var c=this.windowIsLoaded?"":"window";for(var a in this.loadedFiles){if(this.loadedFiles[a]==this.loadRequested){c+=" "+a}}this.addPreloadMsg("waitingFor: "+c);if(c.length==0){this.addPreloadMsg("Processing callbacks");while(this.onLoadCallbacks.length>0){var b=this.onLoadCallbacks.shift();if(b){b()}}}},onLoad:function(b,a){if(a){this.onLoadCallbacks.unshift(b)}else{this.onLoadCallbacks.push(b)}this.checkIfComplete()},isKonqueror:navigator.userAgent.toLowerCase().indexOf("konqueror")>=0,startTime:new Date(),timeStamp:function(){var a=new Date();return(a.getTime()-this.startTime.getTime())+": "},setDebugArea:function(c,a){if(!this.debugArea||a){var b=document.getElementById(c);if(!b){return}this.debugArea=b;b.value=""}},addPreloadMsg:function(a){this.preloadMsgs+=Rico.timeStamp()+a+"\n"},writeDebugMsg:function(b,a){if(this.debugArea){if(a){this.debugArea.value=""}this.debugArea.value+=this.timeStamp()+b+"\n"}else{if(window.console){if(window.console.firebug){window.console.log(this.timeStamp(),b)}else{window.console.log(this.timeStamp()+b)}}else{if(window.opera){window.opera.postError(this.timeStamp()+b)}}}}};Rico.init();