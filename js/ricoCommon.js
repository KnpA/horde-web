if(typeof Rico=="undefined"){throw("Cannot find the Rico object")}if(typeof Prototype=="undefined"){throw("Rico requires the Prototype JavaScript framework")}Rico.prototypeVersion=parseFloat(Prototype.Version.split(".")[0]+"."+Prototype.Version.split(".")[1]);if(Rico.prototypeVersion<1.3){throw("Rico requires Prototype JavaScript framework version 1.3 or greater")}var RicoUtil={getDirectChildrenByTag:function(b,a){a=a.toLowerCase();return $(b).childElements().inject([],function(c,d){if(d.tagName&&d.tagName.toLowerCase()==a){c.push(d)}return c})},createXmlDocument:function(){if(document.implementation&&document.implementation.createDocument){var a=document.implementation.createDocument("","",null);if(a.readyState==null){a.readyState=1;a.addEventListener("load",function(){a.readyState=4;if(typeof a.onreadystatechange=="function"){a.onreadystatechange()}},false)}return a}if(window.ActiveXObject){return Try.these(function(){return new ActiveXObject("MSXML2.DomDocument")},function(){return new ActiveXObject("Microsoft.DomDocument")},function(){return new ActiveXObject("MSXML.DomDocument")},function(){return new ActiveXObject("MSXML3.DomDocument")})||false}return null},getInnerText:function(f,b,g,e){switch(typeof f){case"string":return f;case"undefined":return f;case"number":return f.toString()}var d=f.childNodes;var a=d.length;var h="";for(var c=0;c<a;c++){switch(d[c].nodeType){case 1:if(Element.getStyle(d[c],"display")=="none"){continue}if(e&&Element.hasClassName(d[c],e)){continue}switch(d[c].tagName.toLowerCase()){case"img":if(!b){h+=d[c].alt||d[c].title||d[c].src}break;case"input":if(d[c].type=="hidden"){continue}case"select":case"textarea":if(!g){h+=$F(d[c])||""}break;default:h+=this.getInnerText(d[c],b,g,e);break}break;case 3:h+=d[c].nodeValue;break}}return h},getContentAsString:function(a,b){if(b){return this._getEncodedContent(a)}if(typeof a.xml!="undefined"){return this._getContentAsStringIE(a)}return this._getContentAsStringMozilla(a)},_getEncodedContent:function(a){if(a.innerHTML){return a.innerHTML}switch(a.childNodes.length){case 0:return"";case 1:return a.firstChild.nodeValue;default:return a.childNodes[1].nodeValue}},_getContentAsStringIE:function(a){var c="";for(var b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];c+=(d.nodeType==4)?d.nodeValue:d.xml}return c},_getContentAsStringMozilla:function(b){var a=new XMLSerializer();var d="";for(var c=0;c<b.childNodes.length;c++){var e=b.childNodes[c];if(e.nodeType==4){d+=e.nodeValue}else{d+=a.serializeToString(e)}}return d},docElement:function(){return(document.compatMode&&document.compatMode.indexOf("CSS")!=-1)?document.documentElement:document.getElementsByTagName("body")[0]},windowHeight:function(){if(document.viewport){return document.viewport.getHeight()}else{return window.innerHeight?window.innerHeight:this.docElement().clientHeight}},windowWidth:function(){if(document.viewport){return document.viewport.getWidth()}else{return this.docElement().clientWidth}},docScrollLeft:function(){if(window.pageXOffset){return window.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollLeft){return document.documentElement.scrollLeft}else{if(document.body){return document.body.scrollLeft}else{return 0}}}},docScrollTop:function(){if(window.pageYOffset){return window.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollTop}else{if(document.body){return document.body.scrollTop}else{return 0}}}},nan2zero:function(a){if(typeof(a)=="string"){a=parseInt(a,10)}return isNaN(a)||typeof(a)=="undefined"?0:a},eventKey:function(a){if(typeof(a.keyCode)=="number"){return a.keyCode}else{if(typeof(a.which)=="number"){return a.which}else{if(typeof(a.charCode)=="number"){return a.charCode}}}return-1},getPreviosSiblingByTagName:function(c,b){var a=c.previousSibling;while(a){if((a.tagName==b)&&(a.style.display!="none")){return a}a=a.previousSibling}return null},getParentByTagName:function(d,a,c){var b=d;a=a.toLowerCase();while(b){if(b.tagName&&b.tagName.toLowerCase()==a){if(!c||b.className.indexOf(c)>=0){return b}}b=b.parentNode}return null},wrapChildren:function(b,a,e,c){var d=document.createElement(c||"div");if(e){d.id=e}if(a){d.className=a}while(b.firstChild){d.appendChild(b.firstChild)}b.appendChild(d);return d},formatPosNumber:function(f,g,c,e){var b=f.toFixed(g).split(/\./);if(c){var d=/(\d+)(\d{3})/;while(d.test(b[0])){b[0]=b[0].replace(d,"$1"+c+"$2")}}return b.join(e)},DOMNode_insertAfter:function(a,b){var c=b.parentNode;if(c.lastChild==b){return c.appendChild(a)}else{return c.insertBefore(a,b.nextSibling)}},positionCtlOverIcon:function(g,k){var c=Position.page(k);var j=this.docScrollTop();var a=this.windowHeight();if(g.style.display=="none"){g.style.display="block"}var h=Prototype.Browser.IE?1:2;var b=this.nan2zero(Element.getStyle(k,"padding-left"));g.style.left=(c[0]+b+h)+"px";var i=c[1]+h+j;var f=g.offsetHeight;var e=k.offsetHeight;var d=10;if(i+e+f+d<a+j){i+=e}else{i=Math.max(i-f,j)}g.style.top=i+"px"},createFormField:function(d,b,f,g,a){var e;if(typeof a!="string"){a=g}if(Prototype.Browser.IE){var c=b+' id="'+g+'"';if(f){c+=' type="'+f+'"'}if(b.match(/^(form|input|select|textarea|object|button|img)$/)){c+=' name="'+a+'"'}e=document.createElement("<"+c+" />")}else{e=document.createElement(b);if(f){e.type=f}e.id=g;if(typeof e.name=="string"){e.name=a}}d.appendChild(e);return e},addSelectOption:function(b,c,d){var a=document.createElement("option");if(typeof c=="string"){a.value=c}a.text=d;if(Prototype.Browser.IE){b.add(a)}else{b.add(a,null)}return a},getCookie:function(g){var b=g+"=";var f=b.length;var a=document.cookie.length;var d=0;while(d<a){var c=d+f;if(document.cookie.substring(d,c)==b){var e=document.cookie.indexOf(";",c);if(e==-1){e=document.cookie.length}return unescape(document.cookie.substring(c,e))}d=document.cookie.indexOf(" ",d)+1;if(d==0){break}}return null},setCookie:function(e,g,f,d,a){var h=e+"="+escape(g);if(typeof(f)=="number"){var b=new Date();b.setTime(b.getTime()+(f*24*60*60*1000));h+="; expires="+b.toGMTString()}if(typeof(d)=="string"){h+="; path="+d}if(typeof(a)=="string"){h+="; domain="+a}document.cookie=h}};if(!RicoTranslate){var RicoTranslate={phrases:{},phrasesById:{},thouSep:",",decPoint:".",langCode:"en",re:/^(\W*)\b(.*)\b(\W*)$/,dateFmt:"mm/dd/yyyy",timeFmt:"hh:nn:ss a/pm",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthAbbr:function(a){return this.monthNames[a].substr(0,3)},dayAbbr:function(a){return this.dayNames[a].substr(0,3)},addPhrase:function(b,a){this.phrases[b]=a},getPhrase:function(c){var e=c.split(/\t/);var a,d="";for(var b=0;b<e.length;b++){if(this.re.exec(e[b])){a=this.phrases[RegExp.$2];d+=(typeof a=="string")?RegExp.$1+a+RegExp.$3:e[b]}else{d+=e[b]}}return d},addPhraseId:function(b,a){this.phrasesById[b]=a},getPhraseById:function(d){var b=this.phrasesById[d];if(!b){alert("Error: missing phrase for "+d);return""}if(arguments.length<=1){return b}var c=arguments;return b.replace(/(\$\d)/g,function(e){var a=parseInt(e.charAt(1),10);return(a<c.length)?c[a]:""})}}}if(!Date.prototype.formatDate){Date.prototype.formatDate=function(a){var c=this;var b=(typeof a=="string")?a:"translateDate";switch(b){case"locale":case"localeDateTime":return c.toLocaleString();case"localeDate":return c.toLocaleDateString();case"translate":case"translateDateTime":b=RicoTranslate.dateFmt+" "+RicoTranslate.timeFmt;break;case"translateDate":b=RicoTranslate.dateFmt;break}return b.replace(/(yyyy|yy|mmmm|mmm|mm|dddd|ddd|dd|hh|nn|ss|a\/p)/gi,function(d){var e;switch(d){case"yyyy":return c.getFullYear();case"yy":return c.getFullYear().toString().substr(2);case"mmmm":return RicoTranslate.monthNames[c.getMonth()];case"mmm":return RicoTranslate.monthAbbr(c.getMonth());case"mm":return(c.getMonth()+1).toPaddedString(2);case"m":return(c.getMonth()+1);case"dddd":return RicoTranslate.dayNames[c.getDay()];case"ddd":return RicoTranslate.dayAbbr(c.getDay());case"dd":return c.getDate().toPaddedString(2);case"d":return c.getDate();case"hh":return((e=c.getHours()%12)?e:12).toPaddedString(2);case"h":return((e=c.getHours()%12)?e:12);case"HH":return c.getHours().toPaddedString(2);case"H":return c.getHours();case"nn":return c.getMinutes().toPaddedString(2);case"ss":return c.getSeconds().toPaddedString(2);case"a/p":return c.getHours()<12?"a":"p"}})}}if(!Date.prototype.setISO8601){Date.prototype.setISO8601=function(b,f){if(!b){return false}var e=b.match(/(\d\d\d\d)(?:-?(\d\d)(?:-?(\d\d)(?:[T ](\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|(?:([-+])(\d\d)(?::?(\d\d))?)?)?)?)?)?/);if(!e){return false}if(!f){f=0}var a=new Date(e[1],0,1);if(e[2]){a.setMonth(e[2]-1)}if(e[3]){a.setDate(e[3])}if(e[4]){a.setHours(e[4])}if(e[5]){a.setMinutes(e[5])}if(e[6]){a.setSeconds(e[6])}if(e[7]){a.setMilliseconds(Number("0."+e[7])*1000)}if(e[8]){if(e[10]&&e[11]){f=(Number(e[10])*60)+Number(e[11])}f*=((e[9]=="-")?1:-1);f-=a.getTimezoneOffset()}var c=(Number(a)+(f*60*1000));this.setTime(Number(c));return true}}if(!Date.prototype.toISO8601String){Date.prototype.toISO8601String=function(e,h){if(!e){e=6}var a;if(!h){h="Z";a=this}else{var g=h.match(/([-+])([0-9]{2}):([0-9]{2})/);var c=(Number(g[2])*60)+Number(g[3]);c*=((g[1]=="-")?-1:1);a=new Date(Number(Number(this)+(c*60000)))}var i=function(d){return((d<10)?"0":"")+d};var f=a.getUTCFullYear();if(e>1){f+="-"+i(a.getUTCMonth()+1)}if(e>2){f+="-"+i(a.getUTCDate())}if(e>3){f+="T"+i(a.getUTCHours())+":"+i(a.getUTCMinutes())}if(e>5){var b=Number(a.getUTCSeconds()+"."+((a.getUTCMilliseconds()<100)?"0":"")+i(a.getUTCMilliseconds()));f+=":"+i(b)}else{if(e>4){f+=":"+i(a.getUTCSeconds())}}if(e>3){f+=h}return f}}if(!String.prototype.toISO8601Date){String.prototype.toISO8601Date=function(){var a=new Date();return a.setISO8601(this)?a:null}}if(!String.prototype.formatDate){String.prototype.formatDate=function(a){var b=this.replace(/-/g,"/");var c=new Date(b);return isNaN(c)?this:c.formatDate(a)}}if(!Number.prototype.formatNumber){Number.prototype.formatNumber=function(c){if(isNaN(this)){return"NaN"}var b=this;if(typeof c.multiplier=="number"){b*=c.multiplier}var i=typeof c.decPlaces=="number"?c.decPlaces:0;var e=typeof c.thouSep=="string"?c.thouSep:RicoTranslate.thouSep;var f=typeof c.decPoint=="string"?c.decPoint:RicoTranslate.decPoint;var d=c.prefix||"";var g=c.suffix||"";var a=typeof c.negSign=="string"?c.negSign:"L";a=a.toUpperCase();var j,h;if(b<0){j=RicoUtil.formatPosNumber(-b,i,e,f);if(a=="P"){j="("+j+")"}j=d+j;if(a=="L"){j="-"+j}if(a=="T"){j+="-"}h="negNumber"}else{h=b==0?"zeroNumber":"posNumber";j=d+RicoUtil.formatPosNumber(b,i,e,f)}return"<span class='"+h+"'>"+j+g+"</span>"}}if(!String.prototype.formatNumber){String.prototype.formatNumber=function(a){var b=parseFloat(this.replace(/,/,"."));return isNaN(b)?this:b.formatNumber(a)}}Rico.Shim=Class.create();if(Prototype.Browser.IE){Rico.Shim.prototype={initialize:function(a){this.ifr=document.createElement("iframe");this.ifr.style.position="absolute";this.ifr.style.display="none";this.ifr.style.top="0px";this.ifr.style.left="0px";this.ifr.src="javascript:false;";a.parentNode.appendChild(this.ifr);this.DivRef=a},hide:function(){this.ifr.style.display="none"},move:function(){this.ifr.style.top=this.DivRef.style.top;this.ifr.style.left=this.DivRef.style.left},show:function(){this.ifr.style.width=this.DivRef.offsetWidth;this.ifr.style.height=this.DivRef.offsetHeight;this.move();this.ifr.style.zIndex=this.DivRef.currentStyle.zIndex-1;this.ifr.style.display="block"}}}else{Rico.Shim.prototype={initialize:function(){},hide:function(){},move:function(){},show:function(){}}}Rico.Shadow=Class.create({initialize:function(a){this.div=document.createElement("div");this.div.style.position="absolute";this.div.style.top="0px";this.div.style.left="0px";if(typeof this.div.style.filter=="undefined"){new Image().src=Rico.imgDir+"shadow.png";new Image().src=Rico.imgDir+"shadow_ur.png";new Image().src=Rico.imgDir+"shadow_ll.png";this.createShadow();this.offset=5}else{this.div.style.backgroundColor="#888";this.div.style.filter="progid:DXImageTransform.Microsoft.Blur(makeShadow=1, shadowOpacity=0.3, pixelRadius=3)";this.offset=0}this.div.style.display="none";a.parentNode.appendChild(this.div);this.DivRef=a},createShadow:function(){var e=document.createElement("table");e.style.height="100%";e.style.width="100%";e.cellSpacing=0;e.dir="ltr";var a=e.insertRow(-1);a.style.height="8px";var c=a.insertCell(-1);c.style.width="8px";var b=a.insertCell(-1);b.style.background="transparent url("+Rico.imgDir+"shadow_ur.png) no-repeat right bottom";var g=e.insertRow(-1);var f=g.insertCell(-1);f.style.background="transparent url("+Rico.imgDir+"shadow_ll.png) no-repeat right bottom";var d=g.insertCell(-1);d.style.background="transparent url("+Rico.imgDir+"shadow.png) no-repeat right bottom";this.div.appendChild(e)},hide:function(){this.div.style.display="none"},move:function(){this.div.style.top=(parseInt(this.DivRef.style.top||"0",10)+this.offset)+"px";this.div.style.left=(parseInt(this.DivRef.style.left||"0",10)+this.offset)+"px"},show:function(){this.div.style.width=this.DivRef.offsetWidth+"px";this.div.style.height=this.DivRef.offsetHeight+"px";this.move();this.div.style.zIndex=parseInt(Element.getStyle(this.DivRef,"z-index"),10)-1;this.div.style.display="block"}});Rico.Popup=Class.create({initialize:function(b,a,c){this.options={hideOnEscape:true,hideOnClick:true,ignoreClicks:false,position:"absolute",shadow:true,margin:6,zIndex:1,overflow:"auto",canDragFunc:false};Object.extend(this.options,b||{});if(a){this.setDiv(a,c)}},setDiv:function(b,c){this.divPopup=$(b);var a=this.options.position=="auto"?Element.getStyle(this.divPopup,"position").toLowerCase():this.options.position;if(!this.divPopup||a!="absolute"){return}this.closeFunc=c||this.closePopup.bindAsEventListener(this);this.shim=new Rico.Shim(this.divPopup);if(this.options.shadow){this.shadow=new Rico.Shadow(this.divPopup)}if(this.options.hideOnClick){Event.observe(document,"click",this.closeFunc)}if(this.options.hideOnEscape){Event.observe(document,"keyup",this._checkKey.bindAsEventListener(this))}if(this.options.canDragFunc){Event.observe(this.titleDiv||this.divPopup,"mousedown",this.startDrag.bind(this))}if(this.options.ignoreClicks||this.options.canDragFunc){this.ignoreClicks()}},createPopup:function(b,e,c,a,d,f){var g=document.createElement("div");g.style.position=this.options.position;g.style.zIndex=this.options.zIndex;g.style.overflow=this.options.overflow;g.style.top="0px";g.style.left="0px";g.style.height=c;g.style.width=a;g.className=d||"ricoPopup";if(e){g.innerHTML=e}b.appendChild(g);this.setDiv(g,f);this.contentDiv=g;if(this.options.canDragFunc===true){this.options.canDragFunc=this.safeDragTest.bind(this)}},safeDragTest:function(b,a){return(b.componentFromPoint&&b.componentFromPoint(a.clientX,a.clientY)!="")?false:b==this.divPopup},createWindow:function(f,e,c,a,d){var g=document.createElement("div");this.titleDiv=document.createElement("div");this.contentDiv=document.createElement("div");this.titleDiv.className="ricoTitle";this.titleDiv.innerHTML=f;this.titleDiv.style.position="relative";var b=document.createElement("img");b.src=Rico.imgDir+"close.gif";b.title=RicoTranslate.getPhraseById("close");b.style.cursor="pointer";b.style.position="absolute";b.style.right="0px";this.titleDiv.appendChild(b);this.contentDiv.className="ricoContent";this.contentDiv.innerHTML=e;this.contentDiv.style.height=c;this.contentDiv.style.width=a;this.contentDiv.style.overflow=this.options.overflow;g.style.position=this.options.position;g.style.zIndex=this.options.zIndex;g.style.top="0px";g.style.left="0px";g.style.display="none";g.className=d||"ricoWindow";g.appendChild(this.titleDiv);g.appendChild(this.contentDiv);document.body.appendChild(g);this.setDiv(g);Event.observe(b,"click",this.closePopup.bindAsEventListener(this))},ignoreClicks:function(){Event.observe(this.divPopup,"click",this._ignoreClick.bindAsEventListener(this))},_ignoreClick:function(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}return true},_checkKey:function(a){if(RicoUtil.eventKey(a)==27){this.closeFunc()}return true},move:function(b,a){if(typeof b=="number"){this.divPopup.style.left=b+"px"}if(typeof a=="number"){this.divPopup.style.top=a+"px"}if(this.shim){this.shim.move()}if(this.shadow){this.shadow.move()}},startDrag:function(c){var b=Event.element(c);var a=typeof(this.options.canDragFunc)=="function"?this.options.canDragFunc(b,c):this.options.canDragFunc;if(!a){return}this.divPopup.style.cursor="move";this.lastMouseX=c.clientX;this.lastMouseY=c.clientY;this.dragHandler=this.drag.bindAsEventListener(this);this.dropHandler=this.endDrag.bindAsEventListener(this);Event.observe(document,"mousemove",this.dragHandler);Event.observe(document,"mouseup",this.dropHandler);Event.stop(c)},drag:function(c){var b=parseInt(this.divPopup.style.left,10)+c.clientX-this.lastMouseX;var a=parseInt(this.divPopup.style.top,10)+c.clientY-this.lastMouseY;this.move(b,a);this.lastMouseX=c.clientX;this.lastMouseY=c.clientY;Event.stop(c)},endDrag:function(){this.divPopup.style.cursor="";Event.stopObserving(document,"mousemove",this.dragHandler);Event.stopObserving(document,"mouseup",this.dropHandler);this.dragHandler=null;this.dropHandler=null},openPopup:function(b,a){this.divPopup.style.display="block";if(typeof b=="number"){this.divPopup.style.left=b+"px"}if(typeof a=="number"){this.divPopup.style.top=a+"px"}if(this.shim){this.shim.show()}if(this.shadow){this.shadow.show()}},closePopup:function(){if(this.dragHandler){this.endDrag()}if(this.shim){this.shim.hide()}if(this.shadow){this.shadow.hide()}this.divPopup.style.display="none"}});Rico.includeLoaded("ricoCommon.js");