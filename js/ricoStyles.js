Rico.Color=Class.create({initialize:function(c,b,a){this.rgb={r:c,g:b,b:a}},setRed:function(a){this.rgb.r=a},setGreen:function(a){this.rgb.g=a},setBlue:function(a){this.rgb.b=a},setHue:function(b){var a=this.asHSB();a.h=b;this.rgb=Rico.Color.HSBtoRGB(a.h,a.s,a.b)},setSaturation:function(b){var a=this.asHSB();a.s=b;this.rgb=Rico.Color.HSBtoRGB(a.h,a.s,a.b)},setBrightness:function(a){var c=this.asHSB();c.b=a;this.rgb=Rico.Color.HSBtoRGB(c.h,c.s,c.b)},darken:function(b){var a=this.asHSB();this.rgb=Rico.Color.HSBtoRGB(a.h,a.s,Math.max(a.b-b,0))},brighten:function(b){var a=this.asHSB();this.rgb=Rico.Color.HSBtoRGB(a.h,a.s,Math.min(a.b+b,1))},blend:function(a){this.rgb.r=Math.floor((this.rgb.r+a.rgb.r)/2);this.rgb.g=Math.floor((this.rgb.g+a.rgb.g)/2);this.rgb.b=Math.floor((this.rgb.b+a.rgb.b)/2)},isBright:function(){var a=this.asHSB();return this.asHSB().b>0.5},isDark:function(){return!this.isBright()},asRGB:function(){return"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}});Rico.Color.createFromHex=function(d){if(d.length==4){var b=d;d="#";for(var c=1;c<4;c++){d+=(b.charAt(c)+b.charAt(c))}}if(d.indexOf("#")==0){d=d.substring(1)}if(!d.match(/^[0-9A-Fa-f]{6}$/)){return null}var f=d.substring(0,2);var e=d.substring(2,4);var a=d.substring(4,6);return new Rico.Color(parseInt(f,16),parseInt(e,16),parseInt(a,16))};Rico.Color.createColorFromBackground=function(d){if(!d.style){return new Rico.Color(255,255,255)}var b=Element.getStyle(d,"background-color");if(b.match(/^(transparent|rgba\(0,\s*0,\s*0,\s*0\))$/i)&&d.parentNode){return Rico.Color.createColorFromBackground(d.parentNode)}if(b==null){return new Rico.Color(255,255,255)}if(b.indexOf("rgb(")==0){var a=b.substring(4,b.length-1);var c=a.split(",");return new Rico.Color(parseInt(c[0],10),parseInt(c[1],10),parseInt(c[2],10))}else{if(b.indexOf("#")==0){return Rico.Color.createFromHex(b)}else{return new Rico.Color(255,255,255)}}};Rico.Color.HSBtoRGB=function(i,e,k){var c=0;var d=0;var l=0;if(e==0){c=parseInt(k*255+0.5,10);d=c;l=c}else{var g=(i-Math.floor(i))*6;var j=g-Math.floor(g);var b=k*(1-e);var a=k*(1-e*j);var m=k*(1-(e*(1-j)));switch(parseInt(g,10)){case 0:c=(k*255+0.5);d=(m*255+0.5);l=(b*255+0.5);break;case 1:c=(a*255+0.5);d=(k*255+0.5);l=(b*255+0.5);break;case 2:c=(b*255+0.5);d=(k*255+0.5);l=(m*255+0.5);break;case 3:c=(b*255+0.5);d=(a*255+0.5);l=(k*255+0.5);break;case 4:c=(m*255+0.5);d=(b*255+0.5);l=(k*255+0.5);break;case 5:c=(k*255+0.5);d=(b*255+0.5);l=(a*255+0.5);break}}return{r:parseInt(c,10),g:parseInt(d,10),b:parseInt(l,10)}};Rico.Color.RGBtoHSB=function(a,f,l){var h;var e;var k;var m=(a>f)?a:f;if(l>m){m=l}var i=(a<f)?a:f;if(l<i){i=l}k=m/255;if(m!=0){e=(m-i)/m}else{e=0}if(e==0){h=0}else{var c=(m-a)/(m-i);var j=(m-f)/(m-i);var d=(m-l)/(m-i);if(a==m){h=d-j}else{if(f==m){h=2+c-d}else{h=4+j-c}}h=h/6;if(h<0){h=h+1}}return{h:h,s:e,b:k}};Rico.Color.createGradientV=function(m,n,c){var i=typeof(n)=="string"?Rico.Color.createFromHex(n):n;var f=typeof(c)=="string"?Rico.Color.createFromHex(c):c;if(Prototype.Browser.IE){m.style.filter='progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr="'+i.asHex()+'",EndColorStr="'+f.asHex()+'")'}else{var r=Rico.Color.createColorPath(i,f,Math.min(m.offsetHeight,50));var o=m.offsetHeight,d=r.length;var a=Rico.Color.createGradientContainer();var q=document.createDocumentFragment();for(var k,j,b=0;b<r.length;b++){j=Math.round(o/d)||1;k=document.createElement("div");k.setAttribute("style","height:"+j+"px;width:100%;background-color:"+r[b].asRGB()+";");q.appendChild(k);d--;o-=j}a.appendChild(q);m.appendChild(a);q=null}};Rico.Color.createGradientH=function(k,m,d){var i=typeof(m)=="string"?Rico.Color.createFromHex(m):m;var h=typeof(d)=="string"?Rico.Color.createFromHex(d):d;if(Prototype.Browser.IE){k.style.filter='progid:DXImageTransform.Microsoft.Gradient(GradientType=1,StartColorStr="'+i.asHex()+'",EndColorStr="'+h.asHex()+'")'}else{var r=Rico.Color.createColorPath(i,h,Math.min(k.offsetWidth,50));var n=0,c=k.offsetWidth,f=r.length;var a=Rico.Color.createGradientContainer();var q=document.createDocumentFragment();for(var b=0;b<r.length;b++){var o=Math.round(c/f)||1;var j=document.createElement("div");j.setAttribute("style","position:absolute;top:0px;left:"+n+"px;height:100%;width:"+o+"px;background-color:"+r[b].asRGB()+";");q.appendChild(j);n+=o;f--;c-=o}a.appendChild(q);k.appendChild(a);q=null}};Rico.Color.createGradientContainer=function(){var a=document.createElement("div");a.style.height="100%";a.style.width="100%";a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.zIndex=-1;return a};Rico.Color.createColorPath=function(b,a,e){var d=[];var c=1;var f=1/e;do{d[d.length]=Rico.Color.setColorHue(b,c,a);c-=f}while(c>0);return d};Rico.Color.setColorHue=function(b,a,c){return new Rico.Color(Math.round(b.rgb.r*a+c.rgb.r*(1-a)),Math.round(b.rgb.g*a+c.rgb.g*(1-a)),Math.round(b.rgb.b*a+c.rgb.b*(1-a)))};Rico.Corner={round:function(d,b){d=$(d);this._setOptions(b);var a=this.options.color=="fromElement"?this._background(d):this.options.color;var c=this.options.bgColor=="fromParent"?this._background(d.parentNode):this.options.bgColor;if(Prototype.Browser.Gecko&&this.options.useMoz&&!this.options.border&&Element.getStyle(d,"background-image")=="none"){this._roundCornersGecko(d,a)}else{if(typeof(Element.getStyle(d,"-webkit-border-radius"))=="string"&&!this.options.border){this._roundCornersWebKit(d,a)}else{this._roundCornersImpl(d,a,c)}}},_roundCornersImpl:function(c,a,b){this.options.numSlices=this.options.compact?2:4;this.borderColor=this._borderColor(a,b);if(this.options.border){this._renderBorder(c,b)}if(this._isTopRounded()){this._roundTopCorners(c,a,b)}if(this._isBottomRounded()){this._roundBottomCorners(c,a,b)}},_roundCornersGecko:function(c,b){var a=this.options.compact?"4px":"8px";if(this._hasString(this.options.corners,"all")){Element.setStyle(c,{MozBorderRadius:a},true)}else{if(this._hasString(this.options.corners,"top","tl")){Element.setStyle(c,{MozBorderRadiusTopleft:a},true)}if(this._hasString(this.options.corners,"top","tr")){Element.setStyle(c,{MozBorderRadiusTopright:a},true)}if(this._hasString(this.options.corners,"bottom","bl")){Element.setStyle(c,{MozBorderRadiusBottomleft:a},true)}if(this._hasString(this.options.corners,"bottom","br")){Element.setStyle(c,{MozBorderRadiusBottomright:a},true)}}},_roundCornersWebKit:function(c,b){var a=this.options.compact?"4px":"8px";if(this._hasString(this.options.corners,"all")){Element.setStyle(c,{WebkitBorderRadius:a},true)}else{if(this._hasString(this.options.corners,"top","tl")){Element.setStyle(c,{WebkitBorderTopLeftRadius:a},true)}if(this._hasString(this.options.corners,"top","tr")){Element.setStyle(c,{WebkitBorderTopRightRadius:a},true)}if(this._hasString(this.options.corners,"bottom","bl")){Element.setStyle(c,{WebkitBorderBottomLeftRadius:a},true)}if(this._hasString(this.options.corners,"bottom","br")){Element.setStyle(c,{WebkitBorderBottomRightRadius:a},true)}}},_renderBorder:function(b,c){var d=RicoUtil.wrapChildren(b);var a="1px solid "+this._borderColor(c);Element.setStyle(d,{borderLeft:a,borderRight:a,marginTop:"0px",marginBottom:"0px",padding:"1px",height:"100%"})},_roundTopCorners:function(c,a,e){var d=this._createCorner(e);for(var b=0;b<this.options.numSlices;b++){d.appendChild(this._createCornerSlice(a,e,b,"top"))}c.style.paddingTop="0px";c.insertBefore(d,c.firstChild)},_roundBottomCorners:function(c,a,e){var d=this._createCorner(e);for(var b=(this.options.numSlices-1);b>=0;b--){d.appendChild(this._createCornerSlice(a,e,b,"bottom"))}c.style.paddingBottom=0;c.appendChild(d)},_createCorner:function(b){var a=document.createElement("div");a.style.backgroundColor=(this._isTransparent()?"transparent":b);return a},_createCornerSlice:function(c,d,f,a){var e=document.createElement("span");var b=e.style;b.backgroundColor=c;b.display="block";b.height="1px";b.overflow="hidden";b.fontSize="1px";if(this.options.border&&f==0){b.borderTopStyle="solid";b.borderTopWidth="1px";b.borderLeftWidth="0px";b.borderRightWidth="0px";b.borderBottomWidth="0px";b.height="0px";b.borderColor=this.borderColor}else{if(this.borderColor){b.borderColor=this.borderColor;b.borderStyle="solid";b.borderWidth="0px 1px"}}if(!this.options.compact&&(f==(this.options.numSlices-1))){b.height="2px"}this._setMargin(e,f,a);this._setBorder(e,f,a);return e},_setOptions:function(a){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:true,border:false,compact:false,useMoz:true};Object.extend(this.options,a||{});if(this._isTransparent()){this.options.blend=false}},_whichSideTop:function(){if(this._hasString(this.options.corners,"all","top")){return""}if(this.options.corners.indexOf("tl")>=0&&this.options.corners.indexOf("tr")>=0){return""}if(this.options.corners.indexOf("tl")>=0){return"left"}else{if(this.options.corners.indexOf("tr")>=0){return"right"}}return""},_whichSideBottom:function(){if(this._hasString(this.options.corners,"all","bottom")){return""}if(this.options.corners.indexOf("bl")>=0&&this.options.corners.indexOf("br")>=0){return""}if(this.options.corners.indexOf("bl")>=0){return"left"}else{if(this.options.corners.indexOf("br")>=0){return"right"}}return""},_borderColor:function(a,d){if(a=="transparent"){return d}if(this.options.border){return this.options.border}if(!this.options.blend){return""}var c=Rico.Color.createFromHex(d);var b=Rico.Color.createFromHex(a);if(c==null||b==null){this.options.blend=false;return""}c.blend(b);return c},_setMargin:function(d,e,b){var c=this._marginSize(e);var a=b=="top"?this._whichSideTop():this._whichSideBottom();if(a=="left"){d.style.marginLeft=c+"px";d.style.marginRight="0px"}else{if(a=="right"){d.style.marginRight=c+"px";d.style.marginLeft="0px"}else{d.style.marginLeft=c+"px";d.style.marginRight=c+"px"}}},_setBorder:function(d,e,b){var c=this._borderSize(e);var a=b=="top"?this._whichSideTop():this._whichSideBottom();if(a=="left"){d.style.borderLeftWidth=c+"px";d.style.borderRightWidth="0px"}else{if(a=="right"){d.style.borderRightWidth=c+"px";d.style.borderLeftWidth="0px"}else{d.style.borderLeftWidth=c+"px";d.style.borderRightWidth=c+"px"}}if(this.options.border){d.style.borderLeftWidth=c+"px";d.style.borderRightWidth=c+"px"}},_marginSize:function(e){if(this._isTransparent()){return 0}var d=[5,3,2,1];var a=[3,2,1,0];var c=[2,1];var b=[1,0];if(this.options.compact&&this.options.blend){return b[e]}else{if(this.options.compact){return c[e]}else{if(this.options.blend){return a[e]}else{return d[e]}}}},_borderSize:function(e){var d=[5,3,2,1];var b=[2,1,1,1];var a=[1,0];var c=[0,2,0,0];if(this.options.compact&&(this.options.blend||this._isTransparent())){return 1}else{if(this.options.compact){return a[e]}else{if(this.options.blend){return b[e]}else{if(this.options.border){return c[e]}else{if(this._isTransparent()){return d[e]}}}}}return 0},_background:function(c){try{var a=Element.getStyle(c,"background-color");if(a.match(/^(transparent|rgba\(0,\s*0,\s*0,\s*0\))$/i)&&c.parentNode){return this._background(c.parentNode)}return a==null?"#ffffff":a}catch(b){return"#ffffff"}},_hasString:function(b){for(var a=1;a<arguments.length;a++){if(b.indexOf(arguments[a])>=0){return true}}return false},_isTransparent:function(){return this.options.color=="transparent"},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(a){return a.childNodes.length==1&&a.childNodes[0].nodeType==3}};Rico.includeLoaded("ricoStyles.js");